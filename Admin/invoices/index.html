
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../Quotes/">
      
      
        <link rel="next" href="../Transactions/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.18">
    
    
      
        <title>invoices - InfyInvoices</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="light-blue">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#invoices" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="InfyInvoices" class="md-header__button md-logo" aria-label="InfyInvoices" data-md-component="logo">
      
  <img src="../../logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            InfyInvoices
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              invoices
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="light-blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="light-blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../Login/" class="md-tabs__link">
      Authentication page
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../dashboard/" class="md-tabs__link md-tabs__link--active">
        Admin
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../Client/dashboard/" class="md-tabs__link">
        Client
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../layout/" class="md-tabs__link">
      Layout
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="InfyInvoices" class="md-nav__button md-logo" aria-label="InfyInvoices" data-md-component="logo">
      
  <img src="../../logo.png" alt="logo">

    </a>
    InfyInvoices
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Login/" class="md-nav__link">
        Authentication page
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Admin
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Admin
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../dashboard/" class="md-nav__link">
        Dashboard
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../admins/" class="md-nav__link">
        admins
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../clients/" class="md-nav__link">
        clients
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../categories/" class="md-nav__link">
        categories
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Taxes/" class="md-nav__link">
        Taxes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Products/" class="md-nav__link">
        Products
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Quotes/" class="md-nav__link">
        Quotes
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          invoices
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        invoices
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#route" class="md-nav__link">
    Route
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#controller" class="md-nav__link">
    Controller
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model" class="md-nav__link">
    Model
  </a>
  
    <nav class="md-nav" aria-label="Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#currency-model" class="md-nav__link">
    Currency Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#invoice-model" class="md-nav__link">
    Invoice Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#payment-model" class="md-nav__link">
    Payment Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#product-model" class="md-nav__link">
    Product Model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#view" class="md-nav__link">
    View
  </a>
  
    <nav class="md-nav" aria-label="View">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-livewire-invoice-table" class="md-nav__link">
    The livewire: Invoice table
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list-of-invoices" class="md-nav__link">
    List of invoices
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#new-invoice" class="md-nav__link">
    New invoice
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edit-invoice" class="md-nav__link">
    Edit invoice
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show-invoice" class="md-nav__link">
    Show invoice
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Transactions/" class="md-nav__link">
        Transactions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Payments/" class="md-nav__link">
        Payments
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../InvoiceTemplates/" class="md-nav__link">
        Invoice Templates
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Settings/" class="md-nav__link">
        Settings
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Client
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Client
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Client/dashboard/" class="md-nav__link">
        Dashboard
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Client/quotes/" class="md-nav__link">
        Quotes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Client/invoices/" class="md-nav__link">
        Invoices
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Client/transactions/" class="md-nav__link">
        Transactions
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../layout/" class="md-nav__link">
        Layout
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="invoices">Invoices</h1>
<h2 id="route">Route</h2>
<p>The route <code>Route::resource('invoices', InvoiceController::class);</code> leads to the page <strong>/admin/invoices</strong>, which displays all the invoices we have.</p>
<h2 id="controller">Controller</h2>
<p>The controller of the 'invoices' page located in <strong>app&gt;http&gt;controllers&gt;InvoiceController.php</strong>.</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span>

<span class="k">namespace</span> <span class="nx">App\Http\Controllers</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">App\Exports\AdminInvoicesExport</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">App\Http\Requests\CreateInvoiceRequest</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">App\Http\Requests\UpdateInvoiceRequest</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">App\Mail\InvoicePaymentReminderMail</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">App\Models\Currency</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">App\Models\Invoice</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">App\Models\Payment</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">App\Models\Product</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">App\Repositories\InvoiceRepository</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">App\Repositories\PaymentRepository</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Barryvdh\DomPDF\Facade</span> <span class="k">as</span> <span class="nx">PDF</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Carbon\Carbon</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Exception</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Contracts\Foundation\Application</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Contracts\View\Factory</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Contracts\View\View</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Http\JsonResponse</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Http\RedirectResponse</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Http\Request</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Http\Response</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Support\Facades\App</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Support\Facades\DB</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Support\Facades\Mail</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Laracasts\Flash\Flash</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Maatwebsite\Excel\Facades\Excel</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\BinaryFileResponse</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">InvoiceController</span> <span class="k">extends</span> <span class="nx">AppBaseController</span>
<span class="p">{</span>
    <span class="sd">/** @var InvoiceRepository */</span>
    <span class="k">public</span> <span class="nv">$invoiceRepository</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nx">InvoiceRepository</span> <span class="nv">$invoiceRepo</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">invoiceRepository</span> <span class="o">=</span> <span class="nv">$invoiceRepo</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * @param  Request  $request</span>
<span class="sd">     * @return Application|Factory|View</span>
<span class="sd">     * @throws Exception</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">index</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span><span class="o">:</span> <span class="nx">View</span><span class="o">|</span><span class="nx">Factory</span><span class="o">|</span><span class="nx">Application</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">updateInvoiceOverDueStatus</span><span class="p">();</span>
        <span class="nv">$statusArr</span> <span class="o">=</span> <span class="nx">Invoice</span><span class="o">::</span><span class="na">STATUS_ARR</span><span class="p">;</span>
        <span class="nv">$status</span> <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">status</span><span class="p">;</span>

        <span class="k">return</span> <span class="nx">view</span><span class="p">(</span><span class="s1">&#39;invoices.index&#39;</span><span class="p">,</span> <span class="nb">compact</span><span class="p">(</span><span class="s1">&#39;statusArr&#39;</span><span class="p">,</span> <span class="s1">&#39;status&#39;</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * Show the form for creating a new resource.</span>
<span class="sd">     *</span>
<span class="sd">     * @return Application|Factory|View</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">create</span><span class="p">()</span><span class="o">:</span> <span class="nx">View</span><span class="o">|</span><span class="nx">Factory</span><span class="o">|</span><span class="nx">Application</span>
    <span class="p">{</span>
        <span class="nv">$data</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">invoiceRepository</span><span class="o">-&gt;</span><span class="na">getSyncList</span><span class="p">();</span>
        <span class="nv">$data</span><span class="p">[</span><span class="s1">&#39;currencies&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">getCurrencies</span><span class="p">();</span>
        <span class="nb">unset</span><span class="p">(</span><span class="nv">$data</span><span class="p">[</span><span class="s1">&#39;statusArr&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]);</span>

        <span class="k">return</span> <span class="nx">view</span><span class="p">(</span><span class="s1">&#39;invoices.create&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">with</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * @param  CreateInvoiceRequest  $request</span>
<span class="sd">     * @return JsonResponse</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">store</span><span class="p">(</span><span class="nx">CreateInvoiceRequest</span> <span class="nv">$request</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="nx">DB</span><span class="o">::</span><span class="na">beginTransaction</span><span class="p">();</span>
            <span class="nv">$invoice</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">invoiceRepository</span><span class="o">-&gt;</span><span class="na">saveInvoice</span><span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">all</span><span class="p">());</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">status</span> <span class="o">!=</span> <span class="nx">Invoice</span><span class="o">::</span><span class="na">DRAFT</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">invoiceRepository</span><span class="o">-&gt;</span><span class="na">saveNotification</span><span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">all</span><span class="p">(),</span> <span class="nv">$invoice</span><span class="p">);</span>
                <span class="nx">DB</span><span class="o">::</span><span class="na">commit</span><span class="p">();</span>

                <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">sendResponse</span><span class="p">(</span><span class="nv">$invoice</span><span class="p">,</span> <span class="s1">&#39;Invoice saved &amp; sent successfully.&#39;</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="nx">DB</span><span class="o">::</span><span class="na">commit</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">Exception</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">DB</span><span class="o">::</span><span class="na">rollBack</span><span class="p">();</span>

            <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">sendError</span><span class="p">(</span><span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">());</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">sendResponse</span><span class="p">(</span><span class="nv">$invoice</span><span class="p">,</span> <span class="s1">&#39;Invoice saved successfully.&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * Display the specified resource.</span>
<span class="sd">     *</span>
<span class="sd">     * @param  Invoice  $invoice</span>
<span class="sd">     * @return Application|Factory|View</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">show</span><span class="p">(</span><span class="nx">Invoice</span> <span class="nv">$invoice</span><span class="p">)</span><span class="o">:</span> <span class="nx">View</span><span class="o">|</span><span class="nx">Factory</span><span class="o">|</span><span class="nx">Application</span>
    <span class="p">{</span>
        <span class="nv">$invoiceData</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">invoiceRepository</span><span class="o">-&gt;</span><span class="na">getInvoiceData</span><span class="p">(</span><span class="nv">$invoice</span><span class="p">);</span>

        <span class="k">return</span> <span class="nx">view</span><span class="p">(</span><span class="s1">&#39;invoices.show&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">with</span><span class="p">(</span><span class="nv">$invoiceData</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * @param  Invoice  $invoice</span>
<span class="sd">     * @return Application|Factory|View|RedirectResponse</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">edit</span><span class="p">(</span><span class="nx">Invoice</span> <span class="nv">$invoice</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$invoice</span><span class="o">-&gt;</span><span class="na">status</span> <span class="o">==</span> <span class="nx">Invoice</span><span class="o">::</span><span class="na">PAID</span> <span class="o">||</span> <span class="nv">$invoice</span><span class="o">-&gt;</span><span class="na">status</span> <span class="o">==</span> <span class="nx">Invoice</span><span class="o">::</span><span class="na">PARTIALLY</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">Flash</span><span class="o">::</span><span class="na">error</span><span class="p">(</span><span class="s1">&#39;Paid invoices can not editable.&#39;</span><span class="p">);</span>

            <span class="k">return</span> <span class="nx">redirect</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">route</span><span class="p">(</span><span class="s1">&#39;invoices.index&#39;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nv">$data</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">invoiceRepository</span><span class="o">-&gt;</span><span class="na">prepareEditFormData</span><span class="p">(</span><span class="nv">$invoice</span><span class="p">);</span>
        <span class="nv">$data</span><span class="p">[</span><span class="s1">&#39;selectedInvoiceTaxes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$invoice</span><span class="o">-&gt;</span><span class="na">invoiceTaxes</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">pluck</span><span class="p">(</span><span class="s1">&#39;tax_id&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">toArray</span><span class="p">();</span>
        <span class="nv">$data</span><span class="p">[</span><span class="s1">&#39;currencies&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">getCurrencies</span><span class="p">();</span>

        <span class="k">return</span> <span class="nx">view</span><span class="p">(</span><span class="s1">&#39;invoices.edit&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">with</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * @param  UpdateInvoiceRequest  $request</span>
<span class="sd">     * @param  Invoice  $invoice</span>
<span class="sd">     * @return JsonResponse</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">update</span><span class="p">(</span><span class="nx">UpdateInvoiceRequest</span> <span class="nv">$request</span><span class="p">,</span> <span class="nx">Invoice</span> <span class="nv">$invoice</span><span class="p">)</span><span class="o">:</span> <span class="nx">JsonResponse</span>
    <span class="p">{</span>
        <span class="nv">$input</span> <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">all</span><span class="p">();</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="nx">DB</span><span class="o">::</span><span class="na">beginTransaction</span><span class="p">();</span>
            <span class="nv">$invoice</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">invoiceRepository</span><span class="o">-&gt;</span><span class="na">updateInvoice</span><span class="p">(</span><span class="nv">$invoice</span><span class="o">-&gt;</span><span class="na">id</span><span class="p">,</span> <span class="nv">$input</span><span class="p">);</span>
            <span class="nv">$changes</span> <span class="o">=</span> <span class="nv">$invoice</span><span class="o">-&gt;</span><span class="na">getChanges</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$input</span><span class="p">[</span><span class="s1">&#39;invoiceStatus&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$changes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nv">$input</span><span class="p">[</span><span class="s1">&#39;invoiceStatus&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">invoiceRepository</span><span class="o">-&gt;</span><span class="na">updateNotification</span><span class="p">(</span><span class="nv">$invoice</span><span class="p">,</span> <span class="nv">$input</span><span class="p">,</span> <span class="nv">$changes</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">if</span> <span class="p">(</span><span class="nv">$input</span><span class="p">[</span><span class="s1">&#39;invoiceStatus&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span> <span class="o">&amp;&amp;</span> <span class="nv">$input</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nx">Invoice</span><span class="o">::</span><span class="na">DRAFT</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">invoiceRepository</span><span class="o">-&gt;</span><span class="na">draftStatusUpdate</span><span class="p">(</span><span class="nv">$invoice</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="nx">DB</span><span class="o">::</span><span class="na">commit</span><span class="p">();</span>

                <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">sendResponse</span><span class="p">(</span><span class="nv">$invoice</span><span class="p">,</span> <span class="s1">&#39;Invoice updated &amp; sent successfully.&#39;</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="nx">DB</span><span class="o">::</span><span class="na">commit</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">Exception</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">DB</span><span class="o">::</span><span class="na">rollBack</span><span class="p">();</span>

            <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">sendError</span><span class="p">(</span><span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">());</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">sendResponse</span><span class="p">(</span><span class="nv">$invoice</span><span class="p">,</span> <span class="s1">&#39;Invoice updated successfully.&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * @param  Invoice  $invoice</span>
<span class="sd">     * @return JsonResponse</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">destroy</span><span class="p">(</span><span class="nx">Invoice</span> <span class="nv">$invoice</span><span class="p">)</span><span class="o">:</span> <span class="nx">JsonResponse</span>
    <span class="p">{</span>
        <span class="nv">$invoice</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">();</span>

        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">sendSuccess</span><span class="p">(</span><span class="s1">&#39;Invoice Deleted successfully.&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">getProduct</span><span class="p">(</span><span class="nv">$productId</span><span class="p">)</span><span class="o">:</span> <span class="nx">JsonResponse</span>
    <span class="p">{</span>
        <span class="nv">$product</span> <span class="o">=</span> <span class="nx">Product</span><span class="o">::</span><span class="na">pluck</span><span class="p">(</span><span class="s1">&#39;unit_price&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">toArray</span><span class="p">();</span>

        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">sendResponse</span><span class="p">(</span><span class="nv">$product</span><span class="p">,</span> <span class="s1">&#39;Product Price retrieved successfully.&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * @param $currencyId</span>
<span class="sd">     * @return mixed</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">getInvoiceCurrency</span><span class="p">(</span><span class="nv">$currencyId</span><span class="p">)</span><span class="o">:</span> <span class="nx">mixed</span>
    <span class="p">{</span>
        <span class="nv">$currency</span> <span class="o">=</span> <span class="nx">Currency</span><span class="o">::</span><span class="na">whereId</span><span class="p">(</span><span class="nv">$currencyId</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">first</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">icon</span><span class="p">;</span>

        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">sendResponse</span><span class="p">(</span><span class="nv">$currency</span><span class="p">,</span> <span class="s1">&#39;Invoice Currency retrieved successfully.&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * @param  Invoice  $invoice</span>
<span class="sd">     * @return Response</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">convertToPdf</span><span class="p">(</span><span class="nx">Invoice</span> <span class="nv">$invoice</span><span class="p">)</span><span class="o">:</span> <span class="nx">Response</span>
    <span class="p">{</span>
        <span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;max_execution_time&#39;</span><span class="p">,</span> <span class="mi">36000000</span><span class="p">);</span>
        <span class="nv">$invoice</span><span class="o">-&gt;</span><span class="na">load</span><span class="p">([</span><span class="s1">&#39;client.user&#39;</span><span class="p">,</span> <span class="s1">&#39;invoiceTemplate&#39;</span><span class="p">,</span> <span class="s1">&#39;invoiceItems.product&#39;</span><span class="p">,</span> <span class="s1">&#39;invoiceItems.invoiceItemTax&#39;</span><span class="p">,</span><span class="s1">&#39;invoiceTaxes&#39;</span><span class="p">]);</span>
        <span class="nv">$invoiceData</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">invoiceRepository</span><span class="o">-&gt;</span><span class="na">getPdfData</span><span class="p">(</span><span class="nv">$invoice</span><span class="p">);</span>
        <span class="nv">$invoiceTemplate</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">invoiceRepository</span><span class="o">-&gt;</span><span class="na">getDefaultTemplate</span><span class="p">(</span><span class="nv">$invoice</span><span class="p">);</span>
        <span class="nv">$pdf</span> <span class="o">=</span> <span class="nx">PDF</span><span class="o">::</span><span class="na">loadView</span><span class="p">(</span><span class="s2">&quot;invoices.invoice_template_pdf.</span><span class="si">$invoiceTemplate</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nv">$invoiceData</span><span class="p">);</span>

        <span class="k">return</span> <span class="nv">$pdf</span><span class="o">-&gt;</span><span class="na">stream</span><span class="p">(</span><span class="s1">&#39;invoice.pdf&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * @param  Invoice  $invoice</span>
<span class="sd">     * @param $status</span>
<span class="sd">     * @return mixed</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">updateInvoiceStatus</span><span class="p">(</span><span class="nx">Invoice</span> <span class="nv">$invoice</span><span class="p">,</span> <span class="nv">$status</span><span class="p">)</span><span class="o">:</span> <span class="nx">mixed</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">invoiceRepository</span><span class="o">-&gt;</span><span class="na">draftStatusUpdate</span><span class="p">(</span><span class="nv">$invoice</span><span class="p">);</span>

        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">sendSuccess</span><span class="p">(</span><span class="s1">&#39;Invoice Send successfully.&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">updateInvoiceOverDueStatus</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$invoice</span> <span class="o">=</span> <span class="nx">Invoice</span><span class="o">::</span><span class="na">whereStatus</span><span class="p">(</span><span class="nx">Invoice</span><span class="o">::</span><span class="na">UNPAID</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>
        <span class="nv">$currentDate</span> <span class="o">=</span> <span class="nx">Carbon</span><span class="o">::</span><span class="na">today</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">format</span><span class="p">(</span><span class="s1">&#39;Y-m-d&#39;</span><span class="p">);</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$invoice</span> <span class="k">as</span> <span class="nv">$invoices</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$invoices</span><span class="o">-&gt;</span><span class="na">due_date</span> <span class="o">&lt;</span> <span class="nv">$currentDate</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$invoices</span><span class="o">-&gt;</span><span class="na">update</span><span class="p">([</span>
                    <span class="s1">&#39;status&#39;</span> <span class="o">=&gt;</span> <span class="nx">Invoice</span><span class="o">::</span><span class="na">OVERDUE</span><span class="p">,</span>
                <span class="p">]);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * @param $invoiceId</span>
<span class="sd">     * @return mixed</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">invoicePaymentReminder</span><span class="p">(</span><span class="nv">$invoiceId</span><span class="p">)</span><span class="o">:</span> <span class="nx">mixed</span>
    <span class="p">{</span>
        <span class="nv">$invoice</span> <span class="o">=</span> <span class="nx">Invoice</span><span class="o">::</span><span class="na">with</span><span class="p">([</span><span class="s1">&#39;client.user&#39;</span><span class="p">,</span> <span class="s1">&#39;payments&#39;</span><span class="p">])</span><span class="o">-&gt;</span><span class="na">whereId</span><span class="p">(</span><span class="nv">$invoiceId</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">firstOrFail</span><span class="p">();</span>
        <span class="nv">$paymentReminder</span> <span class="o">=</span> <span class="nx">Mail</span><span class="o">::</span><span class="na">to</span><span class="p">(</span><span class="nv">$invoice</span><span class="o">-&gt;</span><span class="na">client</span><span class="o">-&gt;</span><span class="na">user</span><span class="o">-&gt;</span><span class="na">email</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">send</span><span class="p">(</span><span class="k">new</span> <span class="nx">InvoicePaymentReminderMail</span><span class="p">(</span><span class="nv">$invoice</span><span class="p">));</span>

        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">sendResponse</span><span class="p">(</span><span class="nv">$paymentReminder</span><span class="p">,</span> <span class="s1">&#39;Payment reminder mail send successfully.&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * @return BinaryFileResponse</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">exportInvoicesExcel</span><span class="p">()</span><span class="o">:</span> <span class="nx">BinaryFileResponse</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Excel</span><span class="o">::</span><span class="na">download</span><span class="p">(</span><span class="k">new</span> <span class="nx">AdminInvoicesExport</span><span class="p">(),</span> <span class="s1">&#39;invoice-excel.xlsx&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * @param $invoiceId</span>
<span class="sd">     * @return Application|Factory|View</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">showPublicInvoice</span><span class="p">(</span><span class="nv">$invoiceId</span><span class="p">)</span><span class="o">:</span> <span class="nx">View</span><span class="o">|</span><span class="nx">Factory</span><span class="o">|</span><span class="nx">Application</span>
    <span class="p">{</span>
        <span class="nv">$invoice</span> <span class="o">=</span> <span class="nx">Invoice</span><span class="o">::</span><span class="na">with</span><span class="p">(</span><span class="s1">&#39;client.user&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">whereInvoiceId</span><span class="p">(</span><span class="nv">$invoiceId</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">firstOrFail</span><span class="p">();</span>
        <span class="nv">$invoiceData</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">invoiceRepository</span><span class="o">-&gt;</span><span class="na">getInvoiceData</span><span class="p">(</span><span class="nv">$invoice</span><span class="p">);</span>
        <span class="nv">$invoiceData</span><span class="p">[</span><span class="s1">&#39;statusArr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">Invoice</span><span class="o">::</span><span class="na">STATUS_ARR</span><span class="p">;</span>
        <span class="nv">$invoiceData</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$invoice</span><span class="o">-&gt;</span><span class="na">status</span><span class="p">;</span>
        <span class="nb">unset</span><span class="p">(</span><span class="nv">$invoiceData</span><span class="p">[</span><span class="s1">&#39;statusArr&#39;</span><span class="p">][</span><span class="nx">Invoice</span><span class="o">::</span><span class="na">DRAFT</span><span class="p">]);</span>
        <span class="nv">$invoiceData</span><span class="p">[</span><span class="s1">&#39;paymentType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">Payment</span><span class="o">::</span><span class="na">PAYMENT_TYPE</span><span class="p">;</span>
        <span class="nv">$invoiceData</span><span class="p">[</span><span class="s1">&#39;paymentMode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">invoiceRepository</span><span class="o">-&gt;</span><span class="na">getPaymentGateways</span><span class="p">();</span>
        <span class="nv">$invoiceData</span><span class="p">[</span><span class="s1">&#39;stripeKey&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">getSettingValue</span><span class="p">(</span><span class="s1">&#39;stripe_key&#39;</span><span class="p">);</span>
        <span class="nv">$invoiceData</span><span class="p">[</span><span class="s1">&#39;userLang&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$invoice</span><span class="o">-&gt;</span><span class="na">client</span><span class="o">-&gt;</span><span class="na">user</span><span class="o">-&gt;</span><span class="na">language</span><span class="p">;</span>

        <span class="k">return</span> <span class="nx">view</span><span class="p">(</span><span class="s1">&#39;invoices.public-invoice.public_view&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">with</span><span class="p">(</span><span class="nv">$invoiceData</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">getPublicInvoicePdf</span><span class="p">(</span><span class="nv">$invoiceId</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$invoice</span> <span class="o">=</span> <span class="nx">Invoice</span><span class="o">::</span><span class="na">whereInvoiceId</span><span class="p">(</span><span class="nv">$invoiceId</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">firstOrFail</span><span class="p">();</span>
        <span class="nv">$invoice</span><span class="o">-&gt;</span><span class="na">load</span><span class="p">(</span><span class="s1">&#39;client.user&#39;</span><span class="p">,</span> <span class="s1">&#39;invoiceTemplate&#39;</span><span class="p">,</span> <span class="s1">&#39;invoiceItems.product&#39;</span><span class="p">,</span> <span class="s1">&#39;invoiceItems.invoiceItemTax&#39;</span><span class="p">);</span>
        <span class="nv">$invoiceData</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">invoiceRepository</span><span class="o">-&gt;</span><span class="na">getPdfData</span><span class="p">(</span><span class="nv">$invoice</span><span class="p">);</span>
        <span class="nv">$invoiceTemplate</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">invoiceRepository</span><span class="o">-&gt;</span><span class="na">getDefaultTemplate</span><span class="p">(</span><span class="nv">$invoice</span><span class="p">);</span>
        <span class="nv">$pdf</span> <span class="o">=</span> <span class="nx">PDF</span><span class="o">::</span><span class="na">loadView</span><span class="p">(</span><span class="s2">&quot;invoices.invoice_template_pdf.</span><span class="si">$invoiceTemplate</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nv">$invoiceData</span><span class="p">);</span>

        <span class="k">return</span> <span class="nv">$pdf</span><span class="o">-&gt;</span><span class="na">stream</span><span class="p">(</span><span class="s1">&#39;invoice.pdf&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">showPublicPayment</span><span class="p">(</span><span class="nv">$invoiceId</span><span class="p">)</span><span class="o">:</span> <span class="nx">Factory</span><span class="o">|</span><span class="nx">View</span><span class="o">|</span><span class="nx">Application</span>
    <span class="p">{</span>
        <span class="sd">/** @var PaymentRepository $paymentRepo */</span>
        <span class="nv">$paymentRepo</span> <span class="o">=</span> <span class="nx">App</span><span class="o">::</span><span class="na">make</span><span class="p">(</span><span class="nx">PaymentRepository</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>

        <span class="sd">/** @var Invoice $invoice */</span>
        <span class="nv">$invoice</span> <span class="o">=</span> <span class="nx">Invoice</span><span class="o">::</span><span class="na">whereInvoiceId</span><span class="p">(</span><span class="nv">$invoiceId</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">firstOrFail</span><span class="p">();</span>
        <span class="nv">$totalPayable</span> <span class="o">=</span> <span class="nv">$paymentRepo</span><span class="o">-&gt;</span><span class="na">getTotalPayable</span><span class="p">(</span><span class="nv">$invoice</span><span class="p">);</span>
        <span class="nv">$paymentType</span> <span class="o">=</span> <span class="nx">Payment</span><span class="o">::</span><span class="na">PAYMENT_TYPE</span><span class="p">;</span>
        <span class="nv">$paymentMode</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">invoiceRepository</span><span class="o">-&gt;</span><span class="na">getPaymentGateways</span><span class="p">();</span>
        <span class="nv">$stripeKey</span> <span class="o">=</span> <span class="nx">getSettingValue</span><span class="p">(</span><span class="s1">&#39;stripe_key&#39;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$stripeKey</span><span class="p">))</span> <span class="p">{</span>
            <span class="nv">$stripeKey</span> <span class="o">=</span> <span class="nx">config</span><span class="p">(</span><span class="s1">&#39;services.stripe.key&#39;</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nx">view</span><span class="p">(</span><span class="s1">&#39;invoices.public-invoice.payment&#39;</span><span class="p">,</span>
            <span class="nb">compact</span><span class="p">(</span><span class="s1">&#39;paymentType&#39;</span><span class="p">,</span> <span class="s1">&#39;paymentMode&#39;</span><span class="p">,</span> <span class="s1">&#39;totalPayable&#39;</span><span class="p">,</span> <span class="s1">&#39;stripeKey&#39;</span><span class="p">,</span> <span class="s1">&#39;invoice&#39;</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">updateRecurring</span><span class="p">(</span><span class="nx">Invoice</span> <span class="nv">$invoice</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$recurringCycle</span> <span class="o">=</span> <span class="k">empty</span><span class="p">(</span><span class="nv">$invoice</span><span class="o">-&gt;</span><span class="na">recurring_cycle</span><span class="p">)</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="nv">$invoice</span><span class="o">-&gt;</span><span class="na">recurring_cycle</span><span class="p">;</span>
        <span class="nv">$invoice</span><span class="o">-&gt;</span><span class="na">update</span><span class="p">([</span>
            <span class="s1">&#39;recurring_status&#39;</span> <span class="o">=&gt;</span> <span class="o">!</span> <span class="nv">$invoice</span><span class="o">-&gt;</span><span class="na">recurring_status</span><span class="p">,</span>
            <span class="s1">&#39;recurring_cycle&#39;</span> <span class="o">=&gt;</span> <span class="nv">$recurringCycle</span><span class="p">,</span>
        <span class="p">]);</span>

        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">sendSuccess</span><span class="p">(</span><span class="s1">&#39;Recurring status updated successfully.&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * @return Response</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">exportInvoicesPdf</span><span class="p">()</span><span class="o">:</span> <span class="nx">Response</span>
    <span class="p">{</span>
        <span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;max_execution_time&#39;</span><span class="p">,</span> <span class="mi">3600000000</span><span class="p">);</span>
        <span class="nv">$data</span><span class="p">[</span><span class="s1">&#39;invoices&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">Invoice</span><span class="o">::</span><span class="na">with</span><span class="p">(</span><span class="s1">&#39;client.user&#39;</span><span class="p">,</span> <span class="s1">&#39;payments&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">orderBy</span><span class="p">(</span><span class="s1">&#39;created_at&#39;</span><span class="p">,</span> <span class="s1">&#39;desc&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>
        <span class="nv">$pdf</span> <span class="o">=</span> <span class="nx">PDF</span><span class="o">::</span><span class="na">loadView</span><span class="p">(</span><span class="s2">&quot;invoices.export_invoices_pdf&quot;</span><span class="p">,</span> <span class="nv">$data</span><span class="p">);</span>

        <span class="k">return</span> <span class="nv">$pdf</span><span class="o">-&gt;</span><span class="na">download</span><span class="p">(</span><span class="s1">&#39;Invoices.pdf&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>The <code>InvoiceController</code> is a PHP class that serves as a controller in our application. It handles HTTP requests related to invoice management and interacts with the application's models, repositories, and views to perform various actions. Let's break down the key functionalities and methods of this controller:</p>
<ol>
<li>
<p><strong>Namespace</strong>: The controller is placed in the <code>App\Http\Controllers</code> namespace, which is a standard Laravel convention for organizing controllers.</p>
</li>
<li>
<p><strong>Dependencies</strong>: The controller has several dependencies injected via its constructor, including the <code>InvoiceRepository</code>. This allows it to interact with the database and perform various actions related to invoices.</p>
</li>
<li>
<p><strong>Methods</strong>:</p>
</li>
<li>
<p><code>index</code>: This method handles the display of a list of invoices. It updates the overdue status of invoices and retrieves a list of statuses for filtering.</p>
</li>
<li>
<p><code>create</code>: This method displays a form for creating a new invoice. It retrieves necessary data like currencies and sync lists.</p>
</li>
<li>
<p><code>store</code>: Handles the creation of a new invoice based on the data submitted in the request. It also handles the sending of notifications if the invoice is not in the draft status.</p>
</li>
<li>
<p><code>show</code>: Displays the details of a specific invoice.</p>
</li>
<li>
<p><code>edit</code>: Displays a form for editing an invoice, provided that the invoice is not paid or partially paid.</p>
</li>
<li>
<p><code>update</code>: Handles the update of an existing invoice. It also manages notifications and the status of the invoice.</p>
</li>
<li>
<p><code>destroy</code>: Deletes an invoice.</p>
</li>
<li>
<p><code>getProduct</code>: Retrieves product prices as a JSON response.</p>
</li>
<li>
<p><code>getInvoiceCurrency</code>: Retrieves the currency of an invoice as a JSON response.</p>
</li>
<li>
<p><code>convertToPdf</code>: Generates a PDF representation of an invoice.</p>
</li>
<li>
<p><code>updateInvoiceStatus</code>: Updates the status of an invoice.</p>
</li>
<li>
<p><code>updateInvoiceOverDueStatus</code>: Updates the overdue status of unpaid invoices.</p>
</li>
<li>
<p><code>invoicePaymentReminder</code>: Sends a payment reminder email to the client associated with an invoice.</p>
</li>
<li>
<p><code>exportInvoicesExcel</code>: Exports invoices to an Excel file.</p>
</li>
<li>
<p><code>showPublicInvoice</code>: Displays a public view of an invoice.</p>
</li>
<li>
<p><code>getPublicInvoicePdf</code>: Generates a PDF for a public invoice.</p>
</li>
<li>
<p><code>showPublicPayment</code>: Displays payment information for a public invoice.</p>
</li>
<li>
<p><code>updateRecurring</code>: Updates the recurring status of an invoice.</p>
</li>
<li>
<p><code>exportInvoicesPdf</code>: Exports invoices to a PDF file.</p>
</li>
<li>
<p><strong>Middleware</strong>: The controller uses middleware for authentication and authorization to ensure that only authorized users can access these routes.</p>
</li>
</ol>
<p>Overall, this controller is responsible for managing various aspects of invoices, including their creation, editing, deletion, and display. It also handles exporting invoices to different formats, sending payment reminders, and managing recurring invoices.</p>
<h2 id="model">Model</h2>
<p>The models related to this controller are :<strong>App\Models\Currency</strong> ,<strong>App\Models\Invoice</strong> , <strong>App\Models\Payment</strong> and <strong>App\Models\Product</strong> .</p>
<h3 id="currency-model">Currency Model</h3>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span>

<span class="k">namespace</span> <span class="nx">App\Models</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Illuminate\Database\Eloquent\Builder</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Database\Eloquent\Factories\HasFactory</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Database\Eloquent\Model</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Currency</span> <span class="k">extends</span> <span class="nx">Model</span>
<span class="p">{</span>
    <span class="k">use</span> <span class="nx">HasFactory</span><span class="p">;</span>

    <span class="k">protected</span> <span class="nv">$table</span> <span class="o">=</span> <span class="s1">&#39;currencies&#39;</span><span class="p">;</span>

    <span class="k">protected</span> <span class="nv">$fillable</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;icon&#39;</span><span class="p">,</span> <span class="s1">&#39;code&#39;</span><span class="p">];</span>

    <span class="k">protected</span> <span class="nv">$casts</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span>
        <span class="s1">&#39;icon&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span>
        <span class="s1">&#39;code&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span>
    <span class="p">];</span>

    <span class="k">public</span> <span class="k">static</span> <span class="nv">$rules</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;required|string|unique:currencies,name&#39;</span><span class="p">,</span>
        <span class="s1">&#39;icon&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;required|unique:currencies,icon&#39;</span><span class="p">,</span>
        <span class="s1">&#39;code&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;required|min:3|max:3&#39;</span><span class="p">,</span>
    <span class="p">];</span>
<span class="p">}</span>
</code></pre></div>
<p>The provided code represents a Laravel Eloquent model named <code>Currency</code>. Eloquent is Laravel's implementation of the Active Record pattern, which is used for interacting with database tables. Here's an explanation of this <code>Currency</code> model:</p>
<ol>
<li>
<p><strong>Namespace</strong>: The model is defined within the <code>App\Models</code> namespace, which is a standard Laravel convention for organizing models.</p>
</li>
<li>
<p><strong>Extends Model</strong>: This model class extends <code>Illuminate\Database\Eloquent\Model</code>, which means it inherits various features and functionalities from the Eloquent model class.</p>
</li>
<li>
<p><strong>Use of HasFactory Trait</strong>: The <code>HasFactory</code> trait is included in this model. It's used to enable Laravel's factory support, which allows you to easily create model instances for testing or seeding the database.</p>
</li>
<li>
<p><strong>Table Name</strong>: The <code>protected $table</code> property is set to <code>'currencies'</code>, which specifies the database table associated with this model. In this case, it indicates that the model corresponds to a table named 'currencies' in the database.</p>
</li>
<li>
<p><strong>Fillable Attributes</strong>: The <code>protected $fillable</code> property is an array that lists the attributes of the model that are allowed to be mass-assigned. Mass assignment is commonly used when creating or updating records. In this case, the <code>Currency</code> model allows mass assignment for the 'name,' 'icon,' and 'code' attributes.</p>
</li>
<li>
<p><strong>Attribute Casting</strong>: The <code>protected $casts</code> property is an array that defines the data types to which specific attributes should be cast when retrieving them from the database. Here, it specifies that the 'name,' 'icon,' and 'code' attributes should be treated as strings.</p>
</li>
<li>
<p><strong>Validation Rules</strong>: The <code>public static $rules</code> property defines validation rules for creating or updating <code>Currency</code> instances. These rules are used by Laravel's validation system and can help ensure that the data entered into the model is valid before it is stored in the database. In this case, the rules require that 'name' and 'icon' are unique within the 'currencies' table, and 'code' must be a string with a minimum length of 3 characters and a maximum length of 3 characters.</p>
</li>
</ol>
<p>In summary, the <code>Currency</code> model is used to interact with a database table named 'currencies' and defines the structure and validation rules for currency-related data. It can be used to create, retrieve, update, and delete currency records in the associated database table.</p>
<h3 id="invoice-model">Invoice Model</h3>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span>

<span class="k">namespace</span> <span class="nx">App\Models</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Carbon\Carbon</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Database\Eloquent\Builder</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Database\Eloquent\Collection</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Database\Eloquent\Factories\HasFactory</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Database\Eloquent\Model</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Database\Eloquent\Relations\BelongsTo</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Database\Eloquent\Relations\BelongsToMany</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Database\Eloquent\Relations\HasMany</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Support\Str</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Invoice</span> <span class="k">extends</span> <span class="nx">Model</span>
<span class="p">{</span>
    <span class="k">use</span> <span class="nx">HasFactory</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">const</span> <span class="no">SELECT_DISCOUNT_TYPE</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">public</span> <span class="k">const</span> <span class="no">FIXED</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">public</span> <span class="k">const</span> <span class="no">PERCENTAGE</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">const</span> <span class="no">DISCOUNT_TYPE</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nx">self</span><span class="o">::</span><span class="na">SELECT_DISCOUNT_TYPE</span> <span class="o">=&gt;</span> <span class="s1">&#39;Select Discount Type&#39;</span><span class="p">,</span>
        <span class="nx">self</span><span class="o">::</span><span class="na">FIXED</span> <span class="o">=&gt;</span> <span class="s1">&#39;Fixed&#39;</span><span class="p">,</span>
        <span class="nx">self</span><span class="o">::</span><span class="na">PERCENTAGE</span> <span class="o">=&gt;</span> <span class="s1">&#39;Percentage&#39;</span><span class="p">,</span>
    <span class="p">];</span>

    <span class="k">public</span> <span class="k">const</span> <span class="no">DRAFT</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">public</span> <span class="k">const</span> <span class="no">UNPAID</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">public</span> <span class="k">const</span> <span class="no">PAID</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">public</span> <span class="k">const</span> <span class="no">PARTIALLY</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
    <span class="k">public</span> <span class="k">const</span> <span class="no">OVERDUE</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
    <span class="k">public</span> <span class="k">const</span> <span class="no">STATUS_ALL</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
    <span class="k">public</span> <span class="k">const</span> <span class="no">PROCESSING</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">const</span> <span class="no">STATUS_ARR</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nx">self</span><span class="o">::</span><span class="na">STATUS_ALL</span> <span class="o">=&gt;</span> <span class="s1">&#39;All&#39;</span><span class="p">,</span>
        <span class="nx">self</span><span class="o">::</span><span class="na">DRAFT</span> <span class="o">=&gt;</span> <span class="s1">&#39;Draft&#39;</span><span class="p">,</span>
        <span class="nx">self</span><span class="o">::</span><span class="na">UNPAID</span> <span class="o">=&gt;</span> <span class="s1">&#39;Unpaid&#39;</span><span class="p">,</span>
        <span class="nx">self</span><span class="o">::</span><span class="na">PAID</span> <span class="o">=&gt;</span> <span class="s1">&#39;Paid&#39;</span><span class="p">,</span>
        <span class="nx">self</span><span class="o">::</span><span class="na">PARTIALLY</span> <span class="o">=&gt;</span> <span class="s1">&#39;Partially Paid&#39;</span><span class="p">,</span>
        <span class="nx">self</span><span class="o">::</span><span class="na">OVERDUE</span> <span class="o">=&gt;</span> <span class="s1">&#39;Overdue&#39;</span><span class="p">,</span>
        <span class="nx">self</span><span class="o">::</span><span class="na">PROCESSING</span> <span class="o">=&gt;</span> <span class="s1">&#39;Processing&#39;</span><span class="p">,</span>
    <span class="p">];</span>

    <span class="k">public</span> <span class="k">const</span> <span class="no">RECURRING_OFF</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">const</span> <span class="no">RECURRING_ON</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">const</span> <span class="no">RECURRING_STATUS_ARR</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nx">self</span><span class="o">::</span><span class="na">RECURRING_ON</span> <span class="o">=&gt;</span> <span class="s1">&#39;On&#39;</span><span class="p">,</span>
        <span class="nx">self</span><span class="o">::</span><span class="na">RECURRING_OFF</span> <span class="o">=&gt;</span> <span class="s1">&#39;Off&#39;</span><span class="p">,</span>
    <span class="p">];</span>

    <span class="k">public</span> <span class="k">const</span> <span class="no">MONTHLY</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">public</span> <span class="k">const</span> <span class="no">QUARTERLY</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">public</span> <span class="k">const</span> <span class="no">SEMIANNUALLY</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
    <span class="k">public</span> <span class="k">const</span> <span class="no">ANNUALLY</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">const</span> <span class="no">RECURRING_ARR</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nx">self</span><span class="o">::</span><span class="na">MONTHLY</span> <span class="o">=&gt;</span> <span class="s1">&#39;Monthly&#39;</span><span class="p">,</span>
        <span class="nx">self</span><span class="o">::</span><span class="na">QUARTERLY</span> <span class="o">=&gt;</span> <span class="s1">&#39;Quarterly&#39;</span><span class="p">,</span>
        <span class="nx">self</span><span class="o">::</span><span class="na">SEMIANNUALLY</span> <span class="o">=&gt;</span> <span class="s1">&#39;Semi Annually&#39;</span><span class="p">,</span>
        <span class="nx">self</span><span class="o">::</span><span class="na">ANNUALLY</span> <span class="o">=&gt;</span> <span class="s1">&#39;Annually&#39;</span><span class="p">,</span>
    <span class="p">];</span>

    <span class="sd">/**</span>
<span class="sd">     * Validation rules</span>
<span class="sd">     *</span>
<span class="sd">     * @var array</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">static</span> <span class="nv">$rules</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;client_id&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;required&#39;</span><span class="p">,</span>
        <span class="s1">&#39;invoice_id&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;required|unique:invoices,invoice_id&#39;</span><span class="p">,</span>
        <span class="s1">&#39;invoice_date&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;required&#39;</span><span class="p">,</span>
        <span class="s1">&#39;due_date&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;required&#39;</span><span class="p">,</span>
    <span class="p">];</span>

    <span class="k">public</span> <span class="k">static</span> <span class="nv">$messages</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;client_id.required&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;The Client field is required.&#39;</span><span class="p">,</span>
        <span class="s1">&#39;invoice_date.required&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;The invoice date field is required.&#39;</span><span class="p">,</span>
        <span class="s1">&#39;due_date&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;The invoice Due date field is required.&#39;</span><span class="p">,</span>
    <span class="p">];</span>

    <span class="k">public</span> <span class="nv">$table</span> <span class="o">=</span> <span class="s1">&#39;invoices&#39;</span><span class="p">;</span>

    <span class="k">public</span> <span class="nv">$appends</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;status_label&#39;</span><span class="p">];</span>

    <span class="k">public</span> <span class="nv">$fillable</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;client_id&#39;</span><span class="p">,</span>
        <span class="s1">&#39;invoice_date&#39;</span><span class="p">,</span>
        <span class="s1">&#39;due_date&#39;</span><span class="p">,</span>
        <span class="s1">&#39;invoice_id&#39;</span><span class="p">,</span>
        <span class="s1">&#39;currency_id&#39;</span><span class="p">,</span>
        <span class="s1">&#39;amount&#39;</span><span class="p">,</span>
        <span class="s1">&#39;discount_type&#39;</span><span class="p">,</span>
        <span class="s1">&#39;discount&#39;</span><span class="p">,</span>
        <span class="s1">&#39;final_amount&#39;</span><span class="p">,</span>
        <span class="s1">&#39;note&#39;</span><span class="p">,</span>
        <span class="s1">&#39;term&#39;</span><span class="p">,</span>
        <span class="s1">&#39;template_id&#39;</span><span class="p">,</span>
        <span class="s1">&#39;status&#39;</span><span class="p">,</span>
        <span class="s1">&#39;recurring_status&#39;</span><span class="p">,</span>
        <span class="s1">&#39;recurring_cycle&#39;</span><span class="p">,</span>
        <span class="s1">&#39;last_recurring_on&#39;</span><span class="p">,</span>
        <span class="s1">&#39;parent_id&#39;</span><span class="p">,</span>
    <span class="p">];</span>

    <span class="k">protected</span> <span class="nv">$casts</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;client_id&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
        <span class="s1">&#39;parent_id&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
        <span class="s1">&#39;invoice_date&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;date&#39;</span><span class="p">,</span>
        <span class="s1">&#39;due_date&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;date&#39;</span><span class="p">,</span>
        <span class="s1">&#39;invoice_id&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span>
        <span class="s1">&#39;currency_id&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
        <span class="s1">&#39;amount&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;double&#39;</span><span class="p">,</span>
        <span class="s1">&#39;discount_type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
        <span class="s1">&#39;discount&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;double&#39;</span><span class="p">,</span>
        <span class="s1">&#39;final_amount&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;double&#39;</span><span class="p">,</span>
        <span class="s1">&#39;note&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span>
        <span class="s1">&#39;term&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span>
        <span class="s1">&#39;template_id&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
        <span class="s1">&#39;status&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
        <span class="s1">&#39;recurring_status&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
        <span class="s1">&#39;recurring_cycle&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
        <span class="s1">&#39;last_recurring_on&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;date&#39;</span><span class="p">,</span>
        <span class="s1">&#39;tax&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;double&#39;</span><span class="p">,</span>
    <span class="p">];</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">getStatusLabelAttribute</span><span class="p">()</span><span class="o">:</span> <span class="nx">string</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nx">self</span><span class="o">::</span><span class="na">STATUS_ARR</span><span class="p">[</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">status</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * @return BelongsTo</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">client</span><span class="p">()</span><span class="o">:</span> <span class="nx">BelongsTo</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">belongsTo</span><span class="p">(</span><span class="nx">Client</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="s1">&#39;client_id&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * @return HasMany</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">invoiceItems</span><span class="p">()</span><span class="o">:</span> <span class="nx">HasMany</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasMany</span><span class="p">(</span><span class="nx">InvoiceItem</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * @return string</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">generateUniqueInvoiceId</span><span class="p">()</span><span class="o">:</span> <span class="nx">string</span>
    <span class="p">{</span>
        <span class="nv">$invoiceId</span> <span class="o">=</span> <span class="nb">mb_strtoupper</span><span class="p">(</span><span class="nx">Str</span><span class="o">::</span><span class="na">random</span><span class="p">(</span><span class="mi">6</span><span class="p">));</span>
        <span class="k">while</span> <span class="p">(</span><span class="k">true</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$isExist</span> <span class="o">=</span> <span class="nx">self</span><span class="o">::</span><span class="na">whereInvoiceId</span><span class="p">(</span><span class="nv">$invoiceId</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">exists</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$isExist</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">self</span><span class="o">::</span><span class="na">generateUniqueInvoiceId</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nv">$invoiceId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * @return HasMany</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">payments</span><span class="p">()</span><span class="o">:</span> <span class="nx">HasMany</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasMany</span><span class="p">(</span><span class="nx">Payment</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="s1">&#39;invoice_id&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * @return HasMany</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">AdminPayment</span><span class="p">()</span><span class="o">:</span> <span class="nx">HasMany</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasMany</span><span class="p">(</span><span class="nx">AdminPayment</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="s1">&#39;invoice_id&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * @return BelongsTo</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">invoiceTemplate</span><span class="p">()</span><span class="o">:</span> <span class="nx">BelongsTo</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">belongsTo</span><span class="p">(</span><span class="nx">InvoiceSetting</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="s1">&#39;template_id&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">parentInvoice</span><span class="p">()</span><span class="o">:</span> <span class="nx">BelongsTo</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">belongsTo</span><span class="p">(</span><span class="nx">self</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="s1">&#39;parent_id&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">childInvoices</span><span class="p">()</span><span class="o">:</span> <span class="nx">HasMany</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasMany</span><span class="p">(</span><span class="nx">self</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="s1">&#39;parent_id&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * @param $value</span>
<span class="sd">     * @return Setting|mixed</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">getCurrencyIdAttribute</span><span class="p">(</span><span class="nv">$value</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="k">empty</span><span class="p">(</span><span class="nv">$value</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">Currency</span><span class="o">::</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nv">$value</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">pluck</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">first</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nx">Currency</span><span class="o">::</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="nx">getSettingValue</span><span class="p">(</span><span class="s1">&#39;current_currency&#39;</span><span class="p">))</span><span class="o">-&gt;</span><span class="na">pluck</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">first</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * @param $value</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setInvoiceDateAttribute</span><span class="p">(</span><span class="nv">$value</span><span class="p">)</span><span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">attributes</span><span class="p">[</span><span class="s1">&#39;invoice_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">Carbon</span><span class="o">::</span><span class="na">createFromFormat</span><span class="p">(</span><span class="nx">currentDateFormat</span><span class="p">(),</span>
            <span class="nv">$value</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">translatedFormat</span><span class="p">(</span><span class="s1">&#39;Y-m-d&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * @param $value</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setDueDateAttribute</span><span class="p">(</span><span class="nv">$value</span><span class="p">)</span><span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">attributes</span><span class="p">[</span><span class="s1">&#39;due_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">Carbon</span><span class="o">::</span><span class="na">createFromFormat</span><span class="p">(</span><span class="nx">currentDateFormat</span><span class="p">(),</span>
            <span class="nv">$value</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">translatedFormat</span><span class="p">(</span><span class="s1">&#39;Y-m-d&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * @return BelongsToMany</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">invoiceTaxes</span><span class="p">()</span><span class="o">:</span> <span class="nx">BelongsToMany</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">belongsToMany</span><span class="p">(</span><span class="nx">Tax</span><span class="o">::</span><span class="na">class</span><span class="p">,</span><span class="s1">&#39;invoice_taxes&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>The provided code represents a Laravel Eloquent model named <code>Invoice</code>. This model is used to interact with the 'invoices' database table and represents various attributes and behaviors related to invoices. Let's break down the key aspects of this <code>Invoice</code> model:</p>
<ol>
<li>
<p><strong>Namespace</strong>: The model is defined within the <code>App\Models</code> namespace, which is a standard Laravel convention for organizing models.</p>
</li>
<li>
<p><strong>Extends Model</strong>: This model class extends <code>Illuminate\Database\Eloquent\Model</code>, which means it inherits various features and functionalities from the Eloquent model class.</p>
</li>
<li>
<p><strong>Use of HasFactory Trait</strong>: The <code>HasFactory</code> trait is included in this model. It's used to enable Laravel's factory support, allowing you to easily create model instances for testing or seeding the database.</p>
</li>
<li>
<p><strong>Constants</strong>: The model defines several constant values that represent different aspects of invoices, such as discount types, invoice statuses, recurring statuses, and recurring cycle options. These constants are used to provide meaningful labels and options for invoices.</p>
</li>
<li>
<p><strong>Validation Rules and Messages</strong>: The model defines validation rules and messages using the <code>$rules</code> and <code>$messages</code> static properties. These rules and messages are used for data validation when creating or updating invoice records.</p>
</li>
<li>
<p><strong>Table Name</strong>: The <code>public $table</code> property is set to 'invoices', indicating that this model is associated with the 'invoices' database table.</p>
</li>
<li>
<p><strong>Appends Attribute</strong>: The <code>public $appends</code> property is an array that defines additional attributes that should be included when converting the model to an array or JSON. In this case, it includes a 'status_label' attribute.</p>
</li>
<li>
<p><strong>Fillable Attributes</strong>: The <code>public $fillable</code> property is an array that lists the attributes of the model that are allowed to be mass-assigned. Mass assignment is commonly used when creating or updating records. In this case, it allows mass assignment for various invoice-related attributes.</p>
</li>
<li>
<p><strong>Attribute Casting</strong>: The <code>protected $casts</code> property is an array that defines the data types to which specific attributes should be cast when retrieving them from the database. It ensures that attributes like dates and numeric values are cast to their appropriate data types.</p>
</li>
<li>
<p><strong>Accessors and Mutators</strong>: The model defines accessor methods (<code>getCurrencyIdAttribute</code>, <code>getStatusLabelAttribute</code>) and mutator methods (<code>setInvoiceDateAttribute</code>, <code>setDueDateAttribute</code>) to customize the behavior of attribute access and assignment.</p>
</li>
<li>
<p><strong>Relationships</strong>: The model defines several relationships with other Eloquent models, including:</p>
<ul>
<li><code>client()</code>: Belongs to a <code>Client</code> model.</li>
<li><code>invoiceItems()</code>: Has many <code>InvoiceItem</code> models.</li>
<li><code>payments()</code>: Has many <code>Payment</code> models.</li>
<li><code>AdminPayment()</code>: Has many <code>AdminPayment</code> models.</li>
<li><code>invoiceTemplate()</code>: Belongs to an <code>InvoiceSetting</code> model.</li>
<li><code>parentInvoice()</code>: Belongs to another <code>Invoice</code> model as a parent invoice.</li>
<li><code>childInvoices()</code>: Has many <code>Invoice</code> models as child invoices.</li>
<li><code>invoiceTaxes()</code>: Belongs to many <code>Tax</code> models through the 'invoice_taxes' pivot table.</li>
</ul>
</li>
<li>
<p><strong>Custom Methods</strong>: The model defines custom methods like <code>generateUniqueInvoiceId</code> to generate unique invoice IDs and <code>setInvoiceDateAttribute</code> and <code>setDueDateAttribute</code> to format date attributes.</p>
</li>
</ol>
<h3 id="payment-model">Payment Model</h3>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span>

<span class="k">namespace</span> <span class="nx">App\Models</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Barryvdh\LaravelIdeHelper\Eloquent</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Database\Eloquent\Builder</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Database\Eloquent\Factories\HasFactory</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Database\Eloquent\Model</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Database\Eloquent\Relations\BelongsTo</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Support\Carbon</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Spatie\MediaLibrary\HasMedia</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Spatie\MediaLibrary\InteractsWithMedia</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Spatie\MediaLibrary\MediaCollections\Models\Media</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Payment</span> <span class="k">extends</span> <span class="nx">Model</span> <span class="k">implements</span> <span class="nx">HasMedia</span>
<span class="p">{</span>
    <span class="k">use</span> <span class="nx">HasFactory</span><span class="p">,</span> <span class="nx">InteractsWithMedia</span><span class="p">;</span>

    <span class="k">protected</span> <span class="nv">$table</span> <span class="o">=</span> <span class="s1">&#39;payments&#39;</span><span class="p">;</span>

    <span class="k">protected</span> <span class="nv">$fillable</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;invoice_id&#39;</span><span class="p">,</span> <span class="s1">&#39;amount&#39;</span><span class="p">,</span> <span class="s1">&#39;payment_date&#39;</span><span class="p">,</span> <span class="s1">&#39;payment_mode&#39;</span><span class="p">,</span> <span class="s1">&#39;transaction_id&#39;</span><span class="p">,</span> <span class="s1">&#39;notes&#39;</span><span class="p">,</span> <span class="s1">&#39;is_approved&#39;</span><span class="p">,</span>
    <span class="p">];</span>

    <span class="k">protected</span> <span class="nv">$casts</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;invoice_id&#39;</span>     <span class="o">=&gt;</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
        <span class="s1">&#39;amount&#39;</span>         <span class="o">=&gt;</span> <span class="s1">&#39;double&#39;</span><span class="p">,</span>
        <span class="s1">&#39;payment_date&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;datetime&#39;</span><span class="p">,</span>
        <span class="s1">&#39;payment_mode&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
        <span class="s1">&#39;transaction_id&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span>
        <span class="s1">&#39;meta&#39;</span>           <span class="o">=&gt;</span> <span class="s1">&#39;json&#39;</span><span class="p">,</span>
        <span class="s1">&#39;notes&#39;</span>          <span class="o">=&gt;</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span>
        <span class="s1">&#39;user_id&#39;</span>        <span class="o">=&gt;</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
        <span class="s1">&#39;is_approved&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
    <span class="p">];</span>

    <span class="k">public</span> <span class="nv">$appends</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;payments_mode&#39;</span><span class="p">];</span>

    <span class="k">const</span> <span class="no">PAYMENT_ATTACHMENT</span> <span class="o">=</span> <span class="s1">&#39;payment_attachment&#39;</span><span class="p">;</span>

    <span class="k">const</span> <span class="no">FULLPAYMENT</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">const</span> <span class="no">PARTIALLYPAYMENT</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>

    <span class="k">const</span> <span class="no">PAYMENT_TYPE</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nx">self</span><span class="o">::</span><span class="na">FULLPAYMENT</span>      <span class="o">=&gt;</span> <span class="s1">&#39;Full Payment&#39;</span><span class="p">,</span>
        <span class="nx">self</span><span class="o">::</span><span class="na">PARTIALLYPAYMENT</span> <span class="o">=&gt;</span> <span class="s1">&#39;Partially Payment&#39;</span><span class="p">,</span>
    <span class="p">];</span>

    <span class="k">const</span> <span class="no">PENDING</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">const</span> <span class="no">APPROVED</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">const</span> <span class="no">REJECTED</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">const</span> <span class="no">STATUS_ALL</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
    <span class="k">const</span> <span class="no">PAID</span> <span class="o">=</span> <span class="s1">&#39;Paid&#39;</span><span class="p">;</span>
    <span class="k">const</span> <span class="no">PROCESSING</span> <span class="o">=</span> <span class="s1">&#39;Processing&#39;</span><span class="p">;</span>
    <span class="k">const</span> <span class="no">DENIED</span> <span class="o">=</span> <span class="s1">&#39;Denied&#39;</span><span class="p">;</span>
    <span class="k">const</span> <span class="no">STATUS_ARR_ALL</span> <span class="o">=</span> <span class="s1">&#39;All&#39;</span><span class="p">;</span>

    <span class="k">const</span> <span class="no">PAYMENT_STATUS</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nx">self</span><span class="o">::</span><span class="na">STATUS_ALL</span> <span class="o">=&gt;</span> <span class="nx">self</span><span class="o">::</span><span class="na">STATUS_ARR_ALL</span><span class="p">,</span>
        <span class="nx">self</span><span class="o">::</span><span class="na">PENDING</span>    <span class="o">=&gt;</span> <span class="nx">self</span><span class="o">::</span><span class="na">PROCESSING</span><span class="p">,</span>
        <span class="nx">self</span><span class="o">::</span><span class="na">APPROVED</span>   <span class="o">=&gt;</span> <span class="nx">self</span><span class="o">::</span><span class="na">PAID</span><span class="p">,</span>
        <span class="nx">self</span><span class="o">::</span><span class="na">REJECTED</span>   <span class="o">=&gt;</span> <span class="nx">self</span><span class="o">::</span><span class="na">DENIED</span><span class="p">,</span>
    <span class="p">];</span>

    <span class="k">const</span> <span class="no">STATUS</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;RECEIVED_AMOUNT&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Received Amount&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PAID_AMOUNT&#39;</span>     <span class="o">=&gt;</span> <span class="s1">&#39;Paid Amount&#39;</span><span class="p">,</span>
        <span class="s1">&#39;DUE_AMOUNT&#39;</span>      <span class="o">=&gt;</span> <span class="s1">&#39;Due Amount&#39;</span><span class="p">,</span>
    <span class="p">];</span>

    <span class="k">const</span> <span class="no">MANUAL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">const</span> <span class="no">STRIPE</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">const</span> <span class="no">PAYPAL</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
    <span class="k">const</span> <span class="no">CASH</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
    <span class="k">const</span> <span class="no">RAZORPAY</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
    <span class="k">const</span> <span class="no">ALL</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">const</span> <span class="no">PAYMENT_MODE</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nx">self</span><span class="o">::</span><span class="na">ALL</span>      <span class="o">=&gt;</span> <span class="s1">&#39;All&#39;</span><span class="p">,</span>
        <span class="nx">self</span><span class="o">::</span><span class="na">MANUAL</span>   <span class="o">=&gt;</span> <span class="s1">&#39;Manual&#39;</span><span class="p">,</span>
        <span class="nx">self</span><span class="o">::</span><span class="na">STRIPE</span>   <span class="o">=&gt;</span> <span class="s1">&#39;Stripe&#39;</span><span class="p">,</span>
        <span class="nx">self</span><span class="o">::</span><span class="na">PAYPAL</span>   <span class="o">=&gt;</span> <span class="s1">&#39;Paypal&#39;</span><span class="p">,</span>
        <span class="nx">self</span><span class="o">::</span><span class="na">CASH</span>     <span class="o">=&gt;</span> <span class="s1">&#39;Cash&#39;</span><span class="p">,</span>
        <span class="nx">self</span><span class="o">::</span><span class="na">RAZORPAY</span> <span class="o">=&gt;</span> <span class="s1">&#39;Razorpay&#39;</span><span class="p">,</span>
    <span class="p">];</span>

    <span class="k">public</span> <span class="k">static</span> <span class="nv">$rules</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;payment_type&#39;</span>       <span class="o">=&gt;</span> <span class="s1">&#39;required&#39;</span><span class="p">,</span>
        <span class="s1">&#39;amount&#39;</span>             <span class="o">=&gt;</span> <span class="s1">&#39;required&#39;</span><span class="p">,</span>
        <span class="s1">&#39;payment_mode&#39;</span>       <span class="o">=&gt;</span> <span class="s1">&#39;required&#39;</span><span class="p">,</span>
        <span class="s1">&#39;payment_attachment&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;nullable|mimes:pdf,png,jpeg,jpg&#39;</span><span class="p">,</span>
    <span class="p">];</span>

    <span class="sd">/**</span>
<span class="sd">     * @return string</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">getPaymentAttachmentAttribute</span><span class="p">()</span><span class="o">:</span> <span class="nx">string</span>
    <span class="p">{</span>
        <span class="sd">/** @var Media $media */</span>
        <span class="nv">$media</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getMedia</span><span class="p">(</span><span class="nx">self</span><span class="o">::</span><span class="na">PAYMENT_ATTACHMENT</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">first</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$media</span> <span class="o">!==</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nv">$media</span><span class="o">-&gt;</span><span class="na">getFullUrl</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * @return string</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">getPaymentTypeAttribute</span><span class="p">()</span><span class="o">:</span> <span class="nx">string</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nx">self</span><span class="o">::</span><span class="na">PAYMENT_MODE</span><span class="p">[</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">payment_mode</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * @return string</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">getPaymentsModeAttribute</span><span class="p">()</span><span class="o">:</span> <span class="nx">string</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nx">self</span><span class="o">::</span><span class="na">PAYMENT_MODE</span><span class="p">[</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">payment_mode</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * @return BelongsTo</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">invoice</span><span class="p">()</span><span class="o">:</span> <span class="nx">BelongsTo</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">belongsTo</span><span class="p">(</span><span class="nx">Invoice</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>The provided code represents a Laravel Eloquent model named <code>Payment</code>. This model is used to interact with the 'payments' database table and represents various attributes and behaviors related to payments. Let's break down the key aspects of this <code>Payment</code> model:</p>
<ol>
<li>
<p><strong>Namespace</strong>: The model is defined within the <code>App\Models</code> namespace, which is a standard Laravel convention for organizing models.</p>
</li>
<li>
<p><strong>Extends Model</strong>: This model class extends <code>Illuminate\Database\Eloquent\Model</code>, which means it inherits various features and functionalities from the Eloquent model class.</p>
</li>
<li>
<p><strong>Use of Traits</strong>: The <code>HasFactory</code> and <code>InteractsWithMedia</code> traits are included in this model.</p>
</li>
<li>
<p><code>HasFactory</code> is used to enable Laravel's factory support, allowing you to easily create model instances for testing or seeding the database.</p>
</li>
<li>
<p><code>InteractsWithMedia</code> is used to integrate the model with the Spatie Media Library, which allows you to associate media files (such as payment attachments) with the model.</p>
</li>
<li>
<p><strong>Table Name</strong>: The <code>protected $table</code> property is set to 'payments', indicating that this model is associated with the 'payments' database table.</p>
</li>
<li>
<p><strong>Fillable Attributes</strong>: The <code>protected $fillable</code> property is an array that lists the attributes of the model that are allowed to be mass-assigned. Mass assignment is commonly used when creating or updating records. In this case, it allows mass assignment for various payment-related attributes such as 'invoice_id,' 'amount,' 'payment_date,' 'payment_mode,' 'transaction_id,' 'notes,' and 'is_approved.'</p>
</li>
<li>
<p><strong>Attribute Casting</strong>: The <code>protected $casts</code> property is an array that defines the data types to which specific attributes should be cast when retrieving them from the database. It ensures that attributes like dates, numbers, and JSON fields are cast to their appropriate data types.</p>
</li>
<li>
<p><strong>Appends Attribute</strong>: The <code>public $appends</code> property is an array that defines additional attributes that should be included when converting the model to an array or JSON. In this case, it includes a 'payments_mode' attribute.</p>
</li>
<li>
<p><strong>Constants</strong>: The model defines constant values that represent different aspects of payments, including payment types, payment statuses, and payment modes.</p>
</li>
<li>
<p><strong>Validation Rules</strong>: The model defines validation rules using the <code>$rules</code> static property. These rules are used for data validation when creating or updating payment records.</p>
</li>
<li>
<p><strong>Custom Accessors</strong>: The model defines custom accessor methods (<code>getPaymentAttachmentAttribute</code>, <code>getPaymentTypeAttribute</code>, <code>getPaymentsModeAttribute</code>) to customize the behavior of attribute access. These accessors provide formatted URLs for payment attachments and human-readable labels for payment type and mode.</p>
</li>
<li>
<p><strong>Relationships</strong>: The model defines a relationship with the <code>Invoice</code> model using the <code>invoice()</code> method, indicating that a payment belongs to an invoice.</p>
</li>
</ol>
<p>Overall, the <code>Payment</code> model provides the structure and functionality to work with payment data in a Laravel application. It allows you to associate payments with invoices, manage payment attributes, and interact with media attachments associated with payments.</p>
<h3 id="product-model">Product Model</h3>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span>

<span class="k">namespace</span> <span class="nx">App\Models</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Illuminate\Database\Eloquent\Factories\HasFactory</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Database\Eloquent\Model</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Notifications\Notifiable</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Spatie\MediaLibrary\HasMedia</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Spatie\MediaLibrary\InteractsWithMedia</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Spatie\MediaLibrary\MediaCollections\Models\Media</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Product</span> <span class="k">extends</span> <span class="nx">Model</span> <span class="k">implements</span> <span class="nx">HasMedia</span>
<span class="p">{</span>
    <span class="k">use</span> <span class="nx">HasFactory</span><span class="p">,</span> <span class="nx">Notifiable</span><span class="p">,</span> <span class="nx">InteractsWithMedia</span><span class="p">;</span>

    <span class="k">protected</span> <span class="nv">$table</span> <span class="o">=</span> <span class="s1">&#39;products&#39;</span><span class="p">;</span>

    <span class="k">protected</span> <span class="nv">$fillable</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;code&#39;</span><span class="p">,</span> <span class="s1">&#39;category_id&#39;</span><span class="p">,</span> <span class="s1">&#39;unit_price&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">];</span>

    <span class="k">protected</span> <span class="nv">$casts</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span>
        <span class="s1">&#39;code&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span>
        <span class="s1">&#39;category_id&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
        <span class="s1">&#39;unit_price&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;double&#39;</span><span class="p">,</span>
        <span class="s1">&#39;description&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span>
    <span class="p">];</span>

    <span class="k">const</span> <span class="no">Image</span> <span class="o">=</span> <span class="s1">&#39;product&#39;</span><span class="p">;</span>

    <span class="k">protected</span> <span class="nv">$appends</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;product_image&#39;</span><span class="p">];</span>

    <span class="k">public</span> <span class="k">static</span> <span class="nv">$rules</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;required&#39;</span><span class="p">,</span>
        <span class="s1">&#39;code&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;required|alpha_num|min:3|max:6|unique:products,code&#39;</span><span class="p">,</span>
        <span class="s1">&#39;category_id&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;required&#39;</span><span class="p">,</span>
        <span class="s1">&#39;unit_price&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;required|numeric&#39;</span><span class="p">,</span>
    <span class="p">];</span>

    <span class="k">public</span> <span class="k">static</span> <span class="nv">$messages</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;code.required&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;The product code field is required.&#39;</span><span class="p">,</span>
        <span class="s1">&#39;code.size&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;The product code must be 6 characters.&#39;</span><span class="p">,</span>
        <span class="s1">&#39;code.unique&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;The product code has already been taken.&#39;</span><span class="p">,</span>
    <span class="p">];</span>

    <span class="sd">/**</span>
<span class="sd">     * @return string</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">getProductImageAttribute</span><span class="p">()</span><span class="o">:</span> <span class="nx">string</span>
    <span class="p">{</span>
        <span class="sd">/** @var Media $media */</span>
        <span class="nv">$media</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getMedia</span><span class="p">(</span><span class="nx">self</span><span class="o">::</span><span class="na">Image</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">first</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="k">empty</span><span class="p">(</span><span class="nv">$media</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nv">$media</span><span class="o">-&gt;</span><span class="na">getFullUrl</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nx">asset</span><span class="p">(</span><span class="s1">&#39;images/default-product.jpg&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">category</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasOne</span><span class="p">(</span><span class="nx">Category</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;category_id&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>The provided code represents a Laravel Eloquent model named <code>Product</code>. This model is used to interact with the 'products' database table and represents various attributes and behaviors related to products. Let's break down the key aspects of this <code>Product</code> model:</p>
<ol>
<li>
<p><strong>Namespace</strong>: The model is defined within the <code>App\Models</code> namespace, which is a standard Laravel convention for organizing models.</p>
</li>
<li>
<p><strong>Use of Traits</strong>: The <code>HasFactory</code>, <code>Notifiable</code>, and <code>InteractsWithMedia</code> traits are included in this model.</p>
</li>
<li>
<p><code>HasFactory</code> is used to enable Laravel's factory support, allowing you to easily create model instances for testing or seeding the database.</p>
</li>
<li><code>Notifiable</code> is used to enable notifications for the model.</li>
<li>
<p><code>InteractsWithMedia</code> is used to integrate the model with the Spatie Media Library, allowing you to associate media files (such as product images) with the model.</p>
</li>
<li>
<p><strong>Table Name</strong>: The <code>protected $table</code> property is set to 'products', indicating that this model is associated with the 'products' database table.</p>
</li>
<li>
<p><strong>Fillable Attributes</strong>: The <code>protected $fillable</code> property is an array that lists the attributes of the model that are allowed to be mass-assigned. Mass assignment is commonly used when creating or updating records. In this case, it allows mass assignment for various product-related attributes such as 'name,' 'code,' 'category_id,' 'unit_price,' and 'description.'</p>
</li>
<li>
<p><strong>Attribute Casting</strong>: The <code>protected $casts</code> property is an array that defines the data types to which specific attributes should be cast when retrieving them from the database. It ensures that attributes like strings, integers, and doubles are cast to their appropriate data types.</p>
</li>
<li>
<p><strong>Media Library Integration</strong>: The model integrates with the Spatie Media Library to manage product images. It defines a constant named <code>Image</code> to specify the media collection for product images.</p>
</li>
<li>
<p><strong>Appends Attribute</strong>: The <code>protected $appends</code> property is an array that defines additional attributes that should be included when converting the model to an array or JSON. In this case, it includes a 'product_image' attribute, which provides the URL for the product image.</p>
</li>
<li>
<p><strong>Validation Rules and Messages</strong>: The model defines validation rules using the <code>$rules</code> static property. These rules are used for data validation when creating or updating product records. Custom validation error messages are also defined using the <code>$messages</code> static property.</p>
</li>
<li>
<p><strong>Custom Accessor</strong>: The model defines a custom accessor method (<code>getProductImageAttribute</code>) to customize the behavior of attribute access for the 'product_image' attribute. This accessor provides the URL for the product image associated with the product. If no image is found, it returns a default image URL.</p>
</li>
<li>
<p><strong>Relationships</strong>: The model defines a relationship with the <code>Category</code> model using the <code>category()</code> method. It indicates that a product belongs to a category.</p>
</li>
</ol>
<p>Overall, the <code>Product</code> model provides the structure and functionality to work with product data in a Laravel application. It allows you to manage product attributes, associate products with categories, and handle product images using the Spatie Media Library.</p>
<h2 id="view">View</h2>
<h3 id="the-livewire-invoice-table">The livewire: Invoice table</h3>
<p>The livewire of the 'Invoice table' located in <strong>app&gt;http&gt;livewire&gt;InvoiceTable.php</strong>.</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span>

<span class="k">namespace</span> <span class="nx">App\Http\Livewire</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">App\Models\Invoice</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">App\Models\User</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Database\Eloquent\Builder</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Support\Facades\Auth</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Rappasoft\LaravelLivewireTables\Views\Column</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">InvoiceTable</span> <span class="k">extends</span> <span class="nx">LivewireTableComponent</span>
<span class="p">{</span>
    <span class="k">protected</span> <span class="nv">$model</span> <span class="o">=</span> <span class="nx">Invoice</span><span class="o">::</span><span class="na">class</span><span class="p">;</span>
    <span class="k">protected</span> <span class="nx">string</span> <span class="nv">$tableName</span> <span class="o">=</span> <span class="s1">&#39;invoices&#39;</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$showButtonOnHeader</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$buttonComponent</span> <span class="o">=</span> <span class="s1">&#39;invoices.components.add-button&#39;</span><span class="p">;</span>
    <span class="k">public</span> <span class="nx">bool</span> <span class="nv">$showFilterOnHeader</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$filterComponent</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;invoices.components.filter&#39;</span><span class="p">,</span> <span class="nx">Invoice</span><span class="o">::</span><span class="na">STATUS_ARR</span><span class="p">,</span> <span class="nx">Invoice</span><span class="o">::</span><span class="na">RECURRING_STATUS_ARR</span><span class="p">];</span>
    <span class="k">public</span> <span class="nv">$listeners</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;changeInvoiceStatusFilter&#39;</span><span class="p">,</span> <span class="s1">&#39;changeRecurringStatusFilter&#39;</span><span class="p">,</span> <span class="s1">&#39;resetPageTable&#39;</span><span class="p">];</span>
    <span class="k">public</span> <span class="nv">$status</span> <span class="o">=</span> <span class="nx">Invoice</span><span class="o">::</span><span class="na">STATUS_ALL</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$recurringStatus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>

    <span class="k">protected</span> <span class="nv">$queryString</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">];</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">configure</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">setPrimaryKey</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">setDefaultSort</span><span class="p">(</span><span class="s1">&#39;created_at&#39;</span><span class="p">,</span> <span class="s1">&#39;desc&#39;</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">setQueryStringStatus</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">setThAttributes</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nx">Column</span> <span class="nv">$column</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$column</span><span class="o">-&gt;</span><span class="na">isField</span><span class="p">(</span><span class="s1">&#39;final_amount&#39;</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">return</span> <span class="p">[</span>
                    <span class="s1">&#39;class&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;d-flex justify-content-end&#39;</span><span class="p">,</span>
                <span class="p">];</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$column</span><span class="o">-&gt;</span><span class="na">isField</span><span class="p">(</span><span class="s1">&#39;amount&#39;</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">return</span> <span class="p">[</span>
                    <span class="s1">&#39;class&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;text-end&#39;</span><span class="p">,</span>
                <span class="p">];</span>
            <span class="p">}</span>

            <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;class&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;text-center&#39;</span><span class="p">];</span>
        <span class="p">});</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">setTdAttributes</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nx">Column</span> <span class="nv">$column</span><span class="p">,</span> <span class="nv">$row</span><span class="p">,</span> <span class="nv">$columnIndex</span><span class="p">,</span> <span class="nv">$rowIndex</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$column</span><span class="o">-&gt;</span><span class="na">getField</span><span class="p">(),</span> <span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">]))</span> <span class="p">{</span>
                <span class="k">return</span> <span class="p">[</span>
                    <span class="s1">&#39;class&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;text-center&#39;</span><span class="p">,</span>
                <span class="p">];</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$column</span><span class="o">-&gt;</span><span class="na">getField</span><span class="p">(),</span> <span class="p">[</span><span class="s1">&#39;amount&#39;</span><span class="p">,</span> <span class="s1">&#39;final_amount&#39;</span><span class="p">]))</span> <span class="p">{</span>
                <span class="k">return</span> <span class="p">[</span>
                    <span class="s1">&#39;class&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;text-end&#39;</span><span class="p">,</span>
                <span class="p">];</span>
            <span class="p">}</span>

            <span class="k">return</span> <span class="p">[];</span>
        <span class="p">});</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">columns</span><span class="p">()</span><span class="o">:</span> <span class="k">array</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="nx">Column</span><span class="o">::</span><span class="na">make</span><span class="p">(</span><span class="nx">__</span><span class="p">(</span><span class="s1">&#39;messages.invoice.client&#39;</span><span class="p">),</span> <span class="s1">&#39;client.user.first_name&#39;</span><span class="p">)</span>
                <span class="o">-&gt;</span><span class="na">sortable</span><span class="p">()</span>
                <span class="o">-&gt;</span><span class="na">searchable</span><span class="p">()</span>
                <span class="o">-&gt;</span><span class="na">view</span><span class="p">(</span><span class="s1">&#39;invoices.components.client-name&#39;</span><span class="p">),</span>
            <span class="nx">Column</span><span class="o">::</span><span class="na">make</span><span class="p">(</span><span class="s1">&#39;invoice_id&#39;</span><span class="p">,</span> <span class="s1">&#39;invoice_id&#39;</span><span class="p">)</span>
                <span class="o">-&gt;</span><span class="na">sortable</span><span class="p">()</span>
                <span class="o">-&gt;</span><span class="na">searchable</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">hideIf</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
            <span class="nx">Column</span><span class="o">::</span><span class="na">make</span><span class="p">(</span><span class="s1">&#39;Last Name&#39;</span><span class="p">,</span> <span class="s1">&#39;client.user.last_name&#39;</span><span class="p">)</span>
                <span class="o">-&gt;</span><span class="na">sortable</span><span class="p">()</span>
                <span class="o">-&gt;</span><span class="na">searchable</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">hideIf</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
            <span class="nx">Column</span><span class="o">::</span><span class="na">make</span><span class="p">(</span><span class="nx">__</span><span class="p">(</span><span class="s1">&#39;messages.invoice.invoice_date&#39;</span><span class="p">),</span> <span class="s1">&#39;invoice_date&#39;</span><span class="p">)</span>
                <span class="o">-&gt;</span><span class="na">sortable</span><span class="p">()</span>
                <span class="o">-&gt;</span><span class="na">searchable</span><span class="p">()</span>
                <span class="o">-&gt;</span><span class="na">format</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nv">$value</span><span class="p">,</span> <span class="nv">$row</span><span class="p">,</span> <span class="nx">Column</span> <span class="nv">$column</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="nx">view</span><span class="p">(</span><span class="s1">&#39;invoices.components.invoice-due-date&#39;</span><span class="p">)</span>
                        <span class="o">-&gt;</span><span class="na">withValue</span><span class="p">([</span>
                            <span class="s1">&#39;invoice-date&#39;</span> <span class="o">=&gt;</span> <span class="nv">$row</span><span class="o">-&gt;</span><span class="na">invoice_date</span><span class="p">,</span>
                        <span class="p">]);</span>
                <span class="p">}),</span>
            <span class="nx">Column</span><span class="o">::</span><span class="na">make</span><span class="p">(</span><span class="nx">__</span><span class="p">(</span><span class="s1">&#39;messages.invoice.due_date&#39;</span><span class="p">),</span> <span class="s1">&#39;due_date&#39;</span><span class="p">)</span>
                <span class="o">-&gt;</span><span class="na">sortable</span><span class="p">()</span>
                <span class="o">-&gt;</span><span class="na">searchable</span><span class="p">()</span>
                <span class="o">-&gt;</span><span class="na">format</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nv">$value</span><span class="p">,</span> <span class="nv">$row</span><span class="p">,</span> <span class="nx">Column</span> <span class="nv">$column</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="nx">view</span><span class="p">(</span><span class="s1">&#39;invoices.components.invoice-due-date&#39;</span><span class="p">)</span>
                        <span class="o">-&gt;</span><span class="na">withValue</span><span class="p">([</span>
                            <span class="s1">&#39;due-date&#39;</span> <span class="o">=&gt;</span> <span class="nv">$row</span><span class="o">-&gt;</span><span class="na">due_date</span><span class="p">,</span>
                        <span class="p">]);</span>
                <span class="p">}),</span>
            <span class="nx">Column</span><span class="o">::</span><span class="na">make</span><span class="p">(</span><span class="nx">__</span><span class="p">(</span><span class="s1">&#39;messages.invoice.amount&#39;</span><span class="p">),</span> <span class="s1">&#39;final_amount&#39;</span><span class="p">)</span>
                <span class="o">-&gt;</span><span class="na">sortable</span><span class="p">()</span>
                <span class="o">-&gt;</span><span class="na">searchable</span><span class="p">()</span>
                <span class="o">-&gt;</span><span class="na">view</span><span class="p">(</span><span class="s1">&#39;invoices.components.amount&#39;</span><span class="p">),</span>
            <span class="nx">Column</span><span class="o">::</span><span class="na">make</span><span class="p">(</span><span class="nx">__</span><span class="p">(</span><span class="s1">&#39;messages.invoice.transactions&#39;</span><span class="p">),</span> <span class="s1">&#39;amount&#39;</span><span class="p">)</span>
                <span class="o">-&gt;</span><span class="na">searchable</span><span class="p">()</span>
                <span class="o">-&gt;</span><span class="na">view</span><span class="p">(</span><span class="s1">&#39;invoices.components.transaction&#39;</span><span class="p">),</span>
            <span class="nx">Column</span><span class="o">::</span><span class="na">make</span><span class="p">(</span><span class="nx">__</span><span class="p">(</span><span class="s1">&#39;messages.common.status&#39;</span><span class="p">),</span> <span class="s1">&#39;status&#39;</span><span class="p">)</span>
                <span class="o">-&gt;</span><span class="na">searchable</span><span class="p">()</span>
                <span class="o">-&gt;</span><span class="na">view</span><span class="p">(</span><span class="s1">&#39;invoices.components.transaction-status&#39;</span><span class="p">),</span>
            <span class="nx">Column</span><span class="o">::</span><span class="na">make</span><span class="p">(</span><span class="nx">__</span><span class="p">(</span><span class="s1">&#39;messages.common.action&#39;</span><span class="p">),</span> <span class="s1">&#39;id&#39;</span><span class="p">)</span>
                <span class="o">-&gt;</span><span class="na">view</span><span class="p">(</span><span class="s1">&#39;livewire.invoice-action-button&#39;</span><span class="p">),</span>

        <span class="p">];</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">builder</span><span class="p">()</span><span class="o">:</span> <span class="nx">Builder</span>
    <span class="p">{</span>
        <span class="nv">$query</span> <span class="o">=</span> <span class="nx">Invoice</span><span class="o">::</span><span class="na">with</span><span class="p">([</span><span class="s1">&#39;client.user.media&#39;</span><span class="p">,</span> <span class="s1">&#39;payments&#39;</span><span class="p">])</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;invoices.*&#39;</span><span class="p">)</span>
            <span class="o">-&gt;</span><span class="na">when</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">status</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="o">&amp;&amp;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">status</span> <span class="o">!=</span> <span class="nx">Invoice</span><span class="o">::</span><span class="na">STATUS_ALL</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$query</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nv">$query</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;invoices.status&#39;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">status</span><span class="p">);</span>
            <span class="p">})</span>
            <span class="o">-&gt;</span><span class="na">when</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">recurringStatus</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$query</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nv">$query</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;invoices.recurring_status&#39;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">recurringStatus</span><span class="p">);</span>
            <span class="p">});</span>

        <span class="sd">/** @var User $user */</span>
        <span class="nv">$user</span> <span class="o">=</span> <span class="nx">Auth</span><span class="o">::</span><span class="na">user</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$user</span><span class="o">-&gt;</span><span class="na">hasRole</span><span class="p">(</span><span class="nx">\App\Models\Role</span><span class="o">::</span><span class="na">ROLE_CLIENT</span><span class="p">))</span> <span class="p">{</span>
            <span class="nv">$query</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;invoices.status&#39;</span><span class="p">,</span> <span class="s1">&#39;!=&#39;</span><span class="p">,</span> <span class="nx">Invoice</span><span class="o">::</span><span class="na">DRAFT</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nv">$query</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * @param $status</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">changeInvoiceStatusFilter</span><span class="p">(</span><span class="nv">$status</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">status</span> <span class="o">=</span> <span class="nv">$status</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">setBuilder</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">builder</span><span class="p">());</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * @param $recurringStatus</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">changeRecurringStatusFilter</span><span class="p">(</span><span class="nv">$recurringStatus</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">recurringStatus</span> <span class="o">=</span> <span class="nv">$recurringStatus</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">setBuilder</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">builder</span><span class="p">());</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>The provided code defines a Livewire component named <code>InvoiceTable</code>, which is responsible for rendering a table of invoices and handling various interactions related to filtering and displaying invoice data. Livewire is a Laravel library that allows for building dynamic, interactive web applications.</p>
<p>Here's an explanation of the key elements and functionalities of the <code>InvoiceTable</code> Livewire component:</p>
<ol>
<li>
<p><strong>Model and Table Configuration</strong>:</p>
</li>
<li>
<p><code>$model</code>: Specifies the Eloquent model associated with this Livewire table, which is <code>Invoice::class</code> in this case.</p>
</li>
<li>
<p><code>$tableName</code>: Sets the table name to 'invoices.'</p>
</li>
<li>
<p><strong>Livewire Component Properties</strong>:</p>
</li>
<li>
<p><code>$showButtonOnHeader</code>: Indicates whether to show a button in the table header (set to <code>true</code>).</p>
</li>
<li><code>$buttonComponent</code>: Specifies the Livewire component responsible for rendering the button (set to 'invoices.components.add-button').</li>
<li><code>$showFilterOnHeader</code>: Determines whether to show filters in the table header (set to <code>true</code>).</li>
<li><code>$filterComponent</code>: Specifies the Livewire component responsible for rendering the filters, along with two additional filter options related to invoice status and recurring status.</li>
<li>
<p><code>$listeners</code>: Defines the Livewire listeners that can trigger actions in this component (<code>changeInvoiceStatusFilter</code>, <code>changeRecurringStatusFilter</code>, <code>resetPageTable</code>).</p>
</li>
<li>
<p><strong>Filtering and Status Properties</strong>:</p>
</li>
<li>
<p><code>$status</code>: Represents the selected invoice status (default is <code>Invoice::STATUS_ALL</code>).</p>
</li>
<li>
<p><code>$recurringStatus</code>: Represents the selected recurring status.</p>
</li>
<li>
<p><strong>Query String Configuration</strong>:</p>
</li>
<li>
<p><code>$queryString</code>: Specifies query string parameters for the Livewire component (in this case, only 'status').</p>
</li>
<li>
<p><strong>Configuration Method (<code>configure</code>)</strong>:</p>
</li>
<li>
<p><code>configure()</code>: Contains configuration settings for the Livewire table.</p>
</li>
<li>Sets the primary key, default sorting, and query string status.</li>
<li>
<p>Defines attributes for table headers and cells.</p>
</li>
<li>
<p><strong>Table Columns (<code>columns()</code> method)</strong>:</p>
</li>
<li>
<p>Defines an array of table columns using <code>Column::make</code>.</p>
</li>
<li>Each column specifies a label, field name, sorting, searching, and formatting options.</li>
<li>
<p>The columns include information about the client, invoice ID, last name, invoice date, due date, amount, transactions, and status.</p>
</li>
<li>
<p><strong>Data Builder (<code>builder()</code> method)</strong>:</p>
</li>
<li>
<p>Defines a query builder to fetch invoice data.</p>
</li>
<li>Eager loads related data such as client and payments.</li>
<li>Filters invoices based on the selected status and recurring status.</li>
<li>
<p>Ensures that clients do not see draft invoices.</p>
</li>
<li>
<p><strong>Filtering Methods (<code>changeInvoiceStatusFilter</code> and <code>changeRecurringStatusFilter</code>)</strong>:</p>
</li>
<li>These methods are called by Livewire listeners when the invoice status or recurring status filter changes.</li>
<li>They update the corresponding properties and rebuild the data builder.</li>
</ol>
<p>This <code>InvoiceTable</code> Livewire component provides a flexible and interactive way to display and filter invoice data. Users can apply filters to view invoices with specific statuses or recurring statuses, and the component dynamically updates the table based on the selected criteria.</p>
<h3 id="list-of-invoices">List of invoices</h3>
<p>The list of invoices view is located in : <strong>resources\views\invoice\index.blade.php</strong>.</p>
<div class="highlight"><pre><span></span><code><span class="x">@extends(&#39;layouts.app&#39;)</span>
<span class="x">@section(&#39;title&#39;)</span>
<span class="x">    {{__(&#39;messages.invoices&#39;)}}</span>
<span class="x">@endsection</span>
<span class="x">@section(&#39;content&#39;)</span>
<span class="x">    &lt;div class=&quot;container-fluid&quot;&gt;</span>
<span class="x">        &lt;div class=&quot;d-flex flex-column &quot;&gt;</span>
<span class="x">            @include(&#39;flash::message&#39;)</span>
<span class="x">            &lt;livewire:invoice-table/&gt;</span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">    &lt;/div&gt;</span>
<span class="x">    @include(&#39;invoices.templates.templates&#39;)</span>
<span class="x">    {{ Form::hidden(&#39;currency&#39;, getCurrencySymbol(),[&#39;id&#39; =&gt; &#39;currency&#39;]) }}</span>
<span class="x">    {{ Form::hidden(&#39;status&#39;,  $status,[&#39;id&#39; =&gt; &#39;status&#39;]) }}</span>
<span class="x">@endsection</span>
</code></pre></div>
<p>The provided code is a Blade view file named <code>index.blade.php</code>, which is used for rendering the index (list) page of invoices in a Laravel application. This view extends a layout (<code>layouts.app</code>) and includes various sections to define the page's title, content, and additional elements. Let's break down the contents of this Blade view:</p>
<ol>
<li>
<p><strong>Extending Layout</strong>:</p>
</li>
<li>
<p><code>@extends('layouts.app')</code>: This line specifies that this view extends the <code>layouts.app</code> layout. It means that the content of this view will be embedded within the structure defined in the <code>layouts.app</code> layout.</p>
</li>
<li>
<p><strong>Page Title Section</strong>:</p>
</li>
<li>
<p><code>@section('title')</code>: This section is used to set the title of the page, which will be displayed in the browser's title bar or tab.</p>
</li>
<li>
<p><code>{{__('messages.invoices')}}</code>: This line sets the page title to the translated string for "invoices" using Laravel's translation functionality.</p>
</li>
<li>
<p><strong>Content Section</strong>:</p>
</li>
<li>
<p><code>@section('content')</code>: This section defines the main content of the page.</p>
</li>
<li>
<p><code>&lt;div class="container-fluid"&gt;</code>: This <code>&lt;div&gt;</code> element with the class "container-fluid" is used to create a fluid-width container to hold the page's content.</p>
</li>
<li>
<p><strong>Flash Messages</strong>:</p>
</li>
<li>
<p><code>@include('flash::message')</code>: This line includes a Blade partial view named <code>flash::message</code>, which typically renders flash messages (notifications or alerts) that may have been set in the application. Flash messages are often used to provide feedback to users after certain actions.</p>
</li>
<li>
<p><strong>Livewire Component</strong>:</p>
</li>
<li>
<p><code>&lt;livewire:invoice-table/&gt;</code>: This line embeds a Livewire component named <code>invoice-table</code> in the view. Livewire is a Laravel package for building dynamic, interactive UI components. In this case, it displays an interactive table of invoices. The component is rendered directly within the view.</p>
</li>
<li>
<p><strong>Additional Includes</strong>:</p>
</li>
<li>
<p><code>@include('invoices.templates.templates')</code>: This line includes another Blade partial view named <code>invoices.templates.templates</code>. It includes additional templates or components related to invoices. The specific content of this partial view would depend on the application's requirements.</p>
</li>
<li>
<p><strong>Hidden Form Fields</strong>:</p>
</li>
<li><code>{{ Form::hidden('currency', getCurrencySymbol(),['id' =&gt; 'currency']) }}</code>: This line generates a hidden HTML form input field with the name "currency," populated with the result of the <code>getCurrencySymbol()</code> function. It also sets an "id" attribute for the input element as "currency."</li>
<li><code>{{ Form::hidden('status',  $status,['id' =&gt; 'status']) }}</code>: Similar to the previous line, this generates a hidden form input field with the name "status" and a value of <code>$status</code>. It sets an "id" attribute for the input element as "status."</li>
</ol>
<p>In summary, this Blade view is used for the index page of invoices in a Laravel application. It extends a layout, sets the page title, includes flash messages, displays an interactive Livewire component for listing invoices, and includes additional templates or components related to invoices. It also includes hidden form fields that used for passing data to JavaScript or for other purposes in the application.</p>
<h3 id="new-invoice">New invoice</h3>
<p>The view of the 'New invoice' located in <strong>resources&gt;views&gt;invoices&gt;create.blade.php</strong>.</p>
<div class="highlight"><pre><span></span><code><span class="x">@extends(&#39;layouts.app&#39;)</span>
<span class="x">@section(&#39;title&#39;)</span>
<span class="x">{{ __(&#39;messages.invoice.new_invoice&#39;) }}</span>
<span class="x">@endsection</span>
<span class="x">@section(&#39;header_toolbar&#39;)</span>

<span class="x">&lt;div class=&quot;container-fluid&quot;&gt;</span>
<span class="x">&lt;div class=&quot;d-flex align-items-center justify-content-between mb-5&quot;&gt;</span>
<span class="x">&lt;h1 class=&quot;mb-0&quot;&gt;@yield(&#39;title&#39;)&lt;/h1&gt;</span>
<span class="x">&lt;div class=&quot;text-end&quot;&gt;</span>
<span class="x">&lt;a class=&quot;btn btn-outline-primary float-end&quot;</span>
<span class="x">                   href=&quot;{{ url()-&gt;previous() }}&quot;&gt;{{ __(&#39;messages.common.back&#39;) }}&lt;/a&gt;</span>
<span class="x">&lt;/div&gt;</span>
<span class="x">&lt;/div&gt;</span>
<span class="x">&lt;/div&gt;</span>
<span class="x">@endsection</span>
<span class="x">@section(&#39;content&#39;)</span>
<span class="x">&lt;div class=&quot;container-fluid&quot;&gt;</span>
<span class="x">&lt;div class=&quot;d-flex flex-column&quot;&gt;</span>
<span class="x">&lt;div class=&quot;row&quot;&gt;</span>
<span class="x">&lt;div class=&quot;col-12&quot;&gt;</span>
<span class="x">@include(&#39;layouts.errors&#39;)</span>
<span class="x">&lt;div class=&quot;alert alert-danger display-none hide&quot; id=&quot;validationErrorsBox&quot;&gt;&lt;/div&gt;</span>
<span class="x">&lt;/div&gt;</span>
<span class="x">&lt;/div&gt;</span>
<span class="x">&lt;div class=&quot;card&quot;&gt;</span>
<span class="x">&lt;div class=&quot;card-body&quot;&gt;</span>
<span class="x">{{ Form::open([&#39;route&#39; =&gt; &#39;invoices.store&#39;, &#39;id&#39; =&gt; &#39;invoiceForm&#39;, &#39;name&#39; =&gt; &#39;invoiceForm&#39;]) }}</span>
<span class="x">@include(&#39;invoices.fields&#39;)</span>
<span class="x">{{ Form::close() }}</span>
<span class="x">&lt;/div&gt;</span>
<span class="x">&lt;/div&gt;</span>
<span class="x">&lt;/div&gt;</span>
<span class="x">&lt;/div&gt;</span>
<span class="x">@include(&#39;invoices.templates.templates&#39;)</span>
<span class="x">{{ Form::hidden(&#39;clients&#39;,json_encode($clients, true),[&#39;id&#39; =&gt; &#39;clients&#39;]) }}</span>
<span class="x">{{ Form::hidden(&#39;products&#39;,json_encode($associateProducts, true),[&#39;id&#39; =&gt; &#39;products&#39;]) }}</span>
<span class="x">{{ Form::hidden(&#39;taxes&#39;,json_encode($associateTaxes, true),[&#39;id&#39; =&gt; &#39;taxes&#39;]) }}</span>
<span class="x">{{ Form::hidden(&#39;invoice_note&#39;,isset($invoice-&gt;note) ,[&#39;id&#39; =&gt; &#39;invoiceNote&#39;]) }}</span>
<span class="x">{{ Form::hidden(&#39;invoice_term&#39;,isset($invoice-&gt;term) ,[&#39;id&#39; =&gt; &#39;invoiceTerm&#39;]) }}</span>
<span class="x">{{ Form::hidden(&#39;invoice_recurring&#39;,isset($invoice-&gt;recurring) ,[&#39;id&#39; =&gt; &#39;invoiceRecurring&#39;]) }}</span>
<span class="x">{{ Form::hidden(&#39;thousand_separator&#39;,getSettingValue(&#39;thousand_separator&#39;) ,[&#39;id&#39; =&gt; &#39;thousandSeparator&#39;]) }}</span>
<span class="x">{{ Form::hidden(&#39;decimal_separator&#39;,isset($invoice-&gt;recurring) ,[&#39;id&#39; =&gt; &#39;decimalSeparator&#39;]) }}</span>
<span class="x">{{ Form::hidden(&#39;default_tax&#39;,json_encode($defaultTax, true),[&#39;id&#39; =&gt; &#39;defaultTax&#39;]) }}</span>
<span class="x">@endsection</span>
</code></pre></div>
<p>The provided code is an example of a Blade view file named <code>create.blade.php</code>, which is used for rendering a form to create a new invoice in our application. Let's break down the contents of this Blade view:</p>
<ol>
<li>
<p><strong>Extending Layout</strong>:</p>
</li>
<li>
<p><code>@extends('layouts.app')</code>: This line specifies that this view extends the <code>layouts.app</code> layout. It means that the content of this view will be embedded within the structure defined in the <code>layouts.app</code> layout.</p>
</li>
<li>
<p><strong>Page Title Section</strong>:</p>
</li>
<li>
<p><code>@section('title')</code>: This section is used to set the title of the page, which will be displayed in the browser's title bar or tab.</p>
</li>
<li>
<p><code>{{ __('messages.invoice.new_invoice') }}</code>: This line sets the page title to a translated string for "New Invoice."</p>
</li>
<li>
<p><strong>Header Toolbar Section</strong>:</p>
</li>
<li>
<p><code>@section('header_toolbar')</code>: This section defines the content of the header toolbar at the top of the page.</p>
</li>
<li><code>&lt;div class="container-fluid"&gt;</code>: This <code>&lt;div&gt;</code> element with the class "container-fluid" is used to create a fluid-width container for the header toolbar.</li>
<li>Inside the container, there is a flex container (<code>d-flex</code>) with content aligned vertically (<code>align-items-center</code>) and horizontally (<code>justify-content-between</code>).</li>
<li>Within the flex container, there is an <code>&lt;h1&gt;</code> element displaying the page title obtained from the "title" section.</li>
<li>
<p>Next to the title, there is a "Back" button (<code>&lt;a&gt;</code>) that links to the previous page using <code>url()-&gt;previous()</code>. It's styled as an outline-primary button.</p>
</li>
<li>
<p><strong>Content Section</strong>:</p>
</li>
<li>
<p><code>@section('content')</code>: This section defines the main content of the page.</p>
</li>
<li><code>&lt;div class="container-fluid"&gt;</code>: Similar to the header toolbar section, this <code>&lt;div&gt;</code> element creates a fluid-width container for the page content.</li>
<li>Inside the container, there is a flex container (<code>d-flex</code>) with content arranged in a column (<code>flex-column</code>).</li>
<li>
<p>Within the column, there is a <code>div</code> with a class of "col-12" that includes:</p>
<ul>
<li><code>@include('layouts.errors')</code>: This line includes a Blade partial view named <code>layouts.errors</code>, used for displaying validation errors.</li>
<li>An empty <code>&lt;div&gt;</code> with the class "alert alert-danger display-none hide" and an <code>id</code> of "validationErrorsBox." This <code>div</code> is initially hidden and used for displaying validation error messages.</li>
</ul>
</li>
<li>
<p><strong>Invoice Form</strong>:</p>
</li>
<li>
<p><code>&lt;div class="card"&gt;</code>: This <code>&lt;div&gt;</code> represents a card element.</p>
</li>
<li><code>&lt;div class="card-body"&gt;</code>: Within the card, there is a card body where the main content of the invoice creation form is placed.</li>
<li><code>{{ Form::open(['route' =&gt; 'invoices.store', 'id' =&gt; 'invoiceForm', 'name' =&gt; 'invoiceForm']) }}</code>: This line opens an HTML form using Laravel's Form class. The form is configured to submit data to the 'invoices.store' route, has an <code>id</code> of 'invoiceForm,' and a <code>name</code> of 'invoiceForm.'</li>
<li><code>@include('invoices.fields')</code>: This line includes a Blade partial view named 'invoices.fields.' This is where the fields and inputs for creating a new invoice are defined.</li>
<li>
<p><code>{{ Form::close() }}</code>: This line closes the HTML form.</p>
</li>
<li>
<p><strong>Additional Includes</strong>:</p>
</li>
<li>
<p><code>@include('invoices.templates.templates')</code>: This line includes another Blade partial view named <code>invoices.templates.templates</code>. It includes additional templates or components related to invoices.</p>
</li>
<li>
<p><strong>Hidden Form Fields and Settings</strong>:</p>
</li>
<li>Several hidden form input fields are included using <code>Form::hidden()</code>. These fields are used to pass data to JavaScript or for other purposes in the application. They include data related to clients, products, taxes, invoice notes, invoice terms, recurring settings, thousand and decimal separators, and default tax settings.</li>
</ol>
<p>In summary, this Blade view is used for creating a new invoice in our application. It extends a layout, sets the page title, includes a header toolbar with a "Back" button, displays validation errors if any, and provides a form for entering invoice details. Hidden form fields are used to store various settings and data for use in the view or JavaScript.</p>
<h3 id="edit-invoice">Edit invoice</h3>
<p>The edit invoice page view is located in : <strong>resources\views\invoices\edit.blade.php</strong>.</p>
<div class="highlight"><pre><span></span><code><span class="x">@extends(&#39;layouts.app&#39;)</span>
<span class="x">@section(&#39;title&#39;)</span>
<span class="x">    {{ __(&#39;messages.invoice.edit_invoice&#39;) }}</span>
<span class="x">@endsection</span>
<span class="x">@section(&#39;content&#39;)</span>
<span class="x">    &lt;div class=&quot;container-fluid&quot;&gt;</span>
<span class="x">        &lt;div class=&quot;d-flex flex-column&quot;&gt;</span>
<span class="x">            &lt;div class=&quot;col-12&quot;&gt;</span>
<span class="x">                &lt;div class=&quot;d-flex justify-content-between align-items-end mb-5&quot;&gt;</span>
<span class="x">                    &lt;h1&gt;@yield(&#39;title&#39;)&lt;/h1&gt;</span>
<span class="x">                    &lt;a class=&quot;btn btn-outline-primary float-end&quot;</span>
<span class="x">                       href=&quot;{{ url()-&gt;previous() }}&quot;&gt;{{ __(&#39;messages.common.back&#39;) }}&lt;/a&gt;</span>
<span class="x">                &lt;/div&gt;</span>
<span class="x">                &lt;div class=&quot;col-12&quot;&gt;</span>
<span class="x">                    @include(&#39;layouts.errors&#39;)</span>
<span class="x">                &lt;/div&gt;</span>
<span class="x">                &lt;div class=&quot;card&quot;&gt;</span>
<span class="x">                    &lt;div class=&quot;card-body&quot;&gt;</span>
<span class="x">                        {{ Form::model($invoice, [&#39;route&#39; =&gt; [&#39;invoices.update&#39;, $invoice-&gt;id], &#39;id&#39; =&gt; &#39;invoiceEditForm&#39;]) }}</span>
<span class="x">                        @include(&#39;invoices.edit_fields&#39;)</span>
<span class="x">                        {{ Form::close() }}</span>
<span class="x">                    &lt;/div&gt;</span>
<span class="x">                &lt;/div&gt;</span>
<span class="x">            &lt;/div&gt;</span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">    &lt;/div&gt;</span>
<span class="x">    @include(&#39;invoices.templates.templates&#39;)</span>
<span class="x">    {{ Form::hidden(&#39;invoice_update_url&#39;,route(&#39;invoices.update&#39;, [&#39;invoice&#39; =&gt; $invoice-&gt;id]),[&#39;id&#39; =&gt; &#39;invoiceUpdateUrl&#39;]) }}</span>
<span class="x">    {{ Form::hidden(&#39;invoice_url&#39;,route(&#39;invoices.index&#39;),[&#39;id&#39; =&gt; &#39;invoiceUrl&#39;]) }}</span>
<span class="x">    {{ Form::hidden(&#39;invoice_id&#39;,$invoice-&gt;id,[&#39;id&#39; =&gt; &#39;invoiceId&#39;]) }}</span>
<span class="x">    {{ Form::hidden(&#39;clients&#39;,json_encode($clients, true),[&#39;id&#39; =&gt; &#39;clients&#39;]) }}</span>
<span class="x">    {{ Form::hidden(&#39;products&#39;,json_encode($associateProducts, true),[&#39;id&#39; =&gt; &#39;products&#39;]) }}</span>
<span class="x">    {{ Form::hidden(&#39;taxes&#39;,json_encode($associateTaxes, true),[&#39;id&#39; =&gt; &#39;taxes&#39;]) }}</span>
<span class="x">    {{ Form::hidden(&#39;unique_id&#39;,$invoice-&gt;invoiceItems-&gt;count() + 1 ,[&#39;id&#39; =&gt; &#39;uniqueId&#39;]) }}</span>
<span class="x">    {{ Form::hidden(&#39;invoice_note&#39;,isset($invoice-&gt;note) ? true : false ,[&#39;id&#39; =&gt; &#39;invoiceNote&#39;]) }}</span>
<span class="x">    {{ Form::hidden(&#39;invoice_term&#39;,isset($invoice-&gt;term) ? true : false ,[&#39;id&#39; =&gt; &#39;invoiceTerm&#39;]) }}</span>
<span class="x">    {{ Form::hidden(&#39;invoice_recurring&#39;,isset($invoice-&gt;recurring) ? true : false ,[&#39;id&#39; =&gt; &#39;invoiceRecurring&#39;]) }}</span>
<span class="x">    {{ Form::hidden(&#39;thousand_separator&#39;,getSettingValue(&#39;thousand_separator&#39;) ,[&#39;id&#39; =&gt; &#39;thousandSeparator&#39;]) }}</span>
<span class="x">    {{ Form::hidden(&#39;decimal_separator&#39;,getSettingValue(&#39;decimal_separator&#39;) ,[&#39;id&#39; =&gt; &#39;decimalSeparator&#39;]) }}</span>
<span class="x">    {{ Form::hidden(&#39;default_tax&#39;,json_encode($defaultTax, true) ,[&#39;id&#39; =&gt; &#39;defaultTax&#39;]) }}</span>
<span class="x">    {{ Form::hidden(&#39;edit_due_date&#39;,$invoice-&gt;due_date ,[&#39;id&#39; =&gt; &#39;editDueDate&#39;]) }}</span>
<span class="x">@endsection</span>
</code></pre></div>
<p>The provided code is an example of a Blade view file named <code>edit.blade.php</code>, which is used for editing an existing invoice in our application. Let's break down the contents of this Blade view:</p>
<ol>
<li>
<p><strong>Extending Layout</strong>:</p>
</li>
<li>
<p><code>@extends('layouts.app')</code>: This line specifies that this view extends the <code>layouts.app</code> layout. It means that the content of this view will be embedded within the structure defined in the <code>layouts.app</code> layout.</p>
</li>
<li>
<p><strong>Page Title Section</strong>:</p>
</li>
<li>
<p><code>@section('title')</code>: This section is used to set the title of the page, which will be displayed in the browser's title bar or tab.</p>
</li>
<li>
<p><code>{{ __('messages.invoice.edit_invoice') }}</code>: This line sets the page title to a translated string for "Edit Invoice."</p>
</li>
<li>
<p><strong>Content Section</strong>:</p>
</li>
<li>
<p><code>@section('content')</code>: This section defines the main content of the page.</p>
</li>
<li><code>&lt;div class="container-fluid"&gt;</code>: This <code>&lt;div&gt;</code> element creates a fluid-width container for the page content.</li>
<li>Inside the container, there is a flex container (<code>d-flex</code>) with content arranged in a column (<code>flex-column</code>).</li>
<li>
<p>Within the column, there is a <code>div</code> with a class of "col-12" that includes:</p>
<ul>
<li>A <code>div</code> with classes "d-flex justify-content-between align-items-end mb-5" representing a flex container that aligns its content at the bottom.</li>
<li>Inside this flex container, there is an <code>&lt;h1&gt;</code> element displaying the page title obtained from the "title" section.</li>
<li>Next to the title, there is a "Back" button (<code>&lt;a&gt;</code>) that links to the previous page using <code>url()-&gt;previous()</code>. It's styled as an outline-primary button.</li>
<li>Another <code>div</code> with a class of "col-12" is used to include error messages using <code>@include('layouts.errors')</code>.</li>
</ul>
</li>
<li>
<p><strong>Invoice Form</strong>:</p>
</li>
<li>
<p><code>&lt;div class="card"&gt;</code>: This <code>&lt;div&gt;</code> represents a card element.</p>
</li>
<li><code>&lt;div class="card-body"&gt;</code>: Within the card, there is a card body where the main content of the invoice editing form is placed.</li>
<li><code>{{ Form::model($invoice, ['route' =&gt; ['invoices.update', $invoice-&gt;id], 'id' =&gt; 'invoiceEditForm']) }}</code>: This line opens an HTML form using Laravel's Form class. The form is configured to submit data to the 'invoices.update' route for updating an existing invoice with the given ID. The <code>model</code> method populates the form fields with data from the <code>$invoice</code> model.</li>
<li><code>@include('invoices.edit_fields')</code>: This line includes a Blade partial view named 'invoices.edit_fields.' This is where the fields for editing an invoice are defined.</li>
<li>
<p><code>{{ Form::close() }}</code>: This line closes the HTML form.</p>
</li>
<li>
<p><strong>Additional Includes</strong>:</p>
</li>
<li>
<p><code>@include('invoices.templates.templates')</code>: This line includes another Blade partial view named <code>invoices.templates.templates</code>. It includes additional templates or components related to invoices.</p>
</li>
<li>
<p><strong>Hidden Form Fields and Settings</strong>:</p>
</li>
<li>Several hidden form input fields are included using <code>Form::hidden()</code>. These fields are used to pass data to JavaScript or for other purposes in the application. They include data related to clients, products, taxes, unique identifiers, invoice notes, invoice terms, recurring settings, thousand and decimal separators, default tax settings, and the due date for editing.</li>
</ol>
<p>In summary, this Blade view is used for editing an existing invoice in a Laravel application. It extends a layout, sets the page title, includes a header toolbar with a "Back" button, displays validation errors if any, and provides a form pre-filled with the invoice's existing data. Hidden form fields are used to store various settings and data for use in the view or JavaScript.</p>
<p><strong>invoices.edit_fields :</strong></p>
<div class="highlight"><pre><span></span><code><span class="x">&lt;div class=&quot;row&quot;&gt;</span>
<span class="x">    &lt;div class=&quot;col-lg-3 col-sm-12&quot;&gt;</span>
<span class="x">        @if($invoice-&gt;status == \App\Models\Invoice::DRAFT)</span>
<span class="x">            {{ Form::label(&#39;client_id&#39;, __(&#39;messages.invoice.client&#39;).(&#39;:&#39;),[&#39;class&#39; =&gt; &#39;form-label required fs-6 mb-3&#39;]) }}</span>
<span class="x">            {{ Form::select(&#39;client_id&#39;, $clients, $client_id ?? null, [&#39;class&#39; =&gt; &#39;form-select io-select2&#39;, &#39;id&#39; =&gt; &#39;client_id&#39;, &#39;placeholder&#39; =&gt; __(&#39;messages.invoice.client&#39;),&#39;required&#39;, &#39;data-control&#39; =&gt;&#39;select2&#39;]) }}</span>
<span class="x">        @else</span>
<span class="x">            {{ Form::label(&#39;client_id&#39;, __(&#39;messages.invoice.client&#39;).(&#39;:&#39;),[&#39;class&#39; =&gt; &#39;form-label mb-3&#39;]) }}</span>
<span class="x">            &lt;br&gt;</span>
<span class="x">            &lt;span class=&quot;text-muted h3&quot;&gt;{{ $invoice-&gt;client-&gt;user-&gt;full_name }}&lt;/span&gt;</span>
<span class="x">            &lt;input type=&quot;hidden&quot; value=&quot;{{$invoice-&gt;client-&gt;user_id}}&quot; name=&quot;client_id&quot;&gt;</span>
<span class="x">        @endif</span>
<span class="x">    &lt;/div&gt;</span>
<span class="x">    &lt;div class=&quot;col-lg-3 col-sm-12 mt-3 mt-lg-1 mb-lg-0 mb-3&quot;&gt;</span>
<span class="x">        &lt;h4 class=&quot;align-items-center&quot;&gt;{{__(&#39;messages.invoice.invoice&#39;)}} # &lt;span</span>
<span class="x">                    class=&quot;text-gray-500&quot;&gt;{{ $invoice-&gt;invoice_id }}&lt;/span&gt;&lt;/h4&gt;</span>
<span class="x">        &lt;input type=&quot;hidden&quot; id=&quot;invoiceId&quot; value=&quot;{{ $invoice-&gt;invoice_id }}&quot; name=&quot;invoice_id&quot;/&gt;</span>
<span class="x">    &lt;/div&gt;</span>
<span class="x">    &lt;div class=&quot;col-lg-6 col-sm-12&quot;&gt;</span>
<span class="x">        &lt;div class=&quot;mb-5&quot;&gt;</span>
<span class="x">            {{ Form::label(&#39;status&#39;, __(&#39;messages.common.status&#39;).(&#39;:&#39;), [&#39;class&#39; =&gt; &#39;form-label required mb-3&#39;]) }}</span>
<span class="x">            {{ Form::select(&#39;status&#39;, $statusArr, isset($invoice) ? $invoice-&gt;status : null, [&#39;class&#39; =&gt; &#39;form-select&#39;, &#39;id&#39; =&gt; &#39;status&#39;,&#39;required&#39;,&#39;data-control&#39; =&gt;&#39;select2&#39;]) }}</span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">    &lt;/div&gt;</span>
<span class="x">&lt;/div&gt;</span>
<span class="x">&lt;div class=&quot;row mb-2&quot;&gt;</span>
<span class="x">        &lt;div class=&quot;mb-5 col-lg-3 col-sm-12&quot;&gt;</span>
<span class="x">            {{ Form::label(&#39;invoice_date&#39;, __(&#39;messages.invoice.invoice_date&#39;).(&#39;:&#39;),[&#39;class&#39; =&gt; &#39;form-label required mb-3&#39;]) }}</span>
<span class="x">            {{ Form::text(&#39;invoice_date&#39;,null ,[&#39;class&#39; =&gt; &#39;form-select&#39;, &#39;id&#39; =&gt; &#39;editInvoiceDate&#39;, &#39;autocomplete&#39; =&gt; &#39;off&#39;,&#39;required&#39;]) }}</span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">        &lt;div class=&quot;mb-5 col-lg-3 col-sm-12&quot;&gt;</span>
<span class="x">            {{ Form::label(&#39;due_date&#39;, __(&#39;messages.invoice.due_date&#39;).(&#39;:&#39;),[&#39;class&#39; =&gt; &#39;form-label required mb-3&#39;]) }}</span>
<span class="x">            {{ Form::text(&#39;due_date&#39;, null, [&#39;class&#39; =&gt; &#39;form-select&#39;, &#39;id&#39; =&gt; &#39;editDueDate&#39;, &#39;autocomplete&#39; =&gt; &#39;off&#39;,&#39;required&#39;]) }}</span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">        &lt;div class=&quot;mb-5 col-lg-3 col-sm-12&quot;&gt;</span>
<span class="x">            {{ Form::label(&#39;templateId&#39;, __(&#39;messages.setting.invoice_template&#39;).(&#39;:&#39;),[&#39;class&#39; =&gt; &#39;form-label mb-3&#39;]) }}</span>
<span class="x">            {{ Form::select(&#39;template_id&#39;, $template,isset($invoice) ? $invoice-&gt;template_id:null, [&#39;class&#39; =&gt; &#39;form-select&#39;, &#39;id&#39; =&gt; &#39;templateId&#39;,&#39;required&#39;, &#39;data-control&#39; =&gt;&#39;select2&#39;]) }}</span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">        &lt;div class=&quot;mb-5 col-lg-3 col-sm-12&quot;&gt;</span>
<span class="x">            {{ Form::label(&#39;currencyType&#39;, __(&#39;messages.setting.currencies&#39;).&#39;:&#39;, [&#39;class&#39; =&gt; &#39;form-label mb-3&#39;]) }}</span>
<span class="x">            &lt;select id=&quot;currencyType&quot; class=&quot;form-select invoice-currency-type&quot; name=&quot;currency_id&quot;&gt;</span>
<span class="x">                &lt;option value=&quot;&quot;&gt;Select Currency&lt;/option&gt;</span>
<span class="x">                @foreach($currencies as $key =&gt; $currency)</span>
<span class="x">                    &lt;option value=&quot;{{ $currency[&#39;id&#39;] }}&quot; {{ $invoice-&gt;currency_id == $currency[&#39;id&#39;] ? &#39;selected&#39; : &#39;&#39;}}&gt;{{$currency[&#39;icon&#39;]}}</span>
<span class="x">                        &amp;nbsp;&amp;nbsp;&amp;nbsp; {{$currency[&#39;name&#39;]}}</span>
<span class="x">                    &lt;/option&gt;</span>
<span class="x">                @endforeach</span>
<span class="x">            &lt;/select&gt;</span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">        &lt;div class=&quot;mb-5 col-lg-3 col-sm-12&quot;&gt;</span>
<span class="x">            &lt;label class=&quot;form-check form-switch form-check-custom mt-3&quot;&gt;</span>
<span class="x">                &lt;input class=&quot;form-check-input recurring-status&quot; type=&quot;checkbox&quot;</span>
<span class="x">                       name=&quot;recurring_status&quot;</span>
<span class="x">                       id=&quot;recurringStatusToggle&quot; {{ $invoice-&gt;recurring_status ? &quot;checked&quot; : &quot;&quot; }}&gt;</span>
<span class="x">                &lt;span class=&quot;form-check-label text-gray-600&quot;</span>
<span class="x">                      for=&quot;recurringStatusToggle&quot;&gt;{{__(&#39;messages.invoice.recurring&#39;)}}&lt;/span&gt;&amp;nbsp;&amp;nbsp;</span>
<span class="x">            &lt;/label&gt;</span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">        &lt;div class=&quot;mb-5 col-lg-3 col-sm-12 recurring-cycle-content&quot;&gt;</span>
<span class="x">            {{ Form::label(&#39;recurringCycle&#39;, __(&#39;messages.invoice.recurring_cycle&#39;).&#39;:&#39;, [&#39;class&#39; =&gt; &#39;form-label mb-3&#39;]) }}</span>
<span class="x">            {{ Form::number(&#39;recurring_cycle&#39;, $invoice-&gt;recurring_cycle, [&#39;class&#39; =&gt; &#39;form-control&#39;, &#39;id&#39; =&gt; &#39;recurringCycle&#39;, &#39;autocomplete&#39; =&gt; &#39;off&#39;, &#39;placeholder&#39;=&gt;&#39;Number of Days for Recurring Cycle&#39;]) }}</span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">    &lt;/div&gt;</span>
<span class="x">&lt;div class=&quot;mb-0&quot;&gt;</span>
<span class="x">    &lt;div class=&quot;col-12 text-end mb-lg-10 mb-6&quot;&gt;</span>
<span class="x">        &lt;button type=&quot;button&quot; class=&quot;btn btn-primary text-start&quot;</span>
<span class="x">                id=&quot;addItem&quot;&gt; {{ __(&#39;messages.invoice.add&#39;) }}&lt;/button&gt;</span>
<span class="x">    &lt;/div&gt;</span>
<span class="x">    &lt;div class=&quot;table-responsive&quot;&gt;</span>
<span class="x">        &lt;table class=&quot;table table-striped box-shadow-none mt-4&quot; id=&quot;billTbl&quot;&gt;</span>
<span class="x">            &lt;thead&gt;</span>
<span class="x">            &lt;tr class=&quot;border-bottom fs-7 fw-bolder text-gray-700 text-uppercase&quot;&gt;</span>
<span class="x">                &lt;th scope=&quot;col&quot;&gt;#&lt;/th&gt;</span>
<span class="x">                &lt;th scope=&quot;col&quot; class=&quot;required&quot;&gt;{{ __(&#39;messages.product.product&#39;) }}&lt;/th&gt;</span>
<span class="x">                &lt;th scope=&quot;col&quot; class=&quot;required&quot;&gt;{{ __(&#39;messages.invoice.qty&#39;) }}&lt;/th&gt;</span>
<span class="x">                &lt;th scope=&quot;col&quot; class=&quot;required&quot;&gt;{{ __(&#39;messages.product.unit_price&#39;) }}&lt;/th&gt;</span>
<span class="x">                &lt;th scope=&quot;col&quot;&gt;{{ __(&#39;messages.invoice.tax&#39;) }}&lt;/th&gt;</span>
<span class="x">                &lt;th scope=&quot;col&quot; class=&quot;required&quot;&gt;{{ __(&#39;messages.invoice.amount&#39;) }}&lt;/th&gt;</span>
<span class="x">                &lt;th scope=&quot;col&quot; class=&quot;text-end&quot;&gt;{{ __(&#39;messages.common.action&#39;) }}&lt;/th&gt;</span>
<span class="x">            &lt;/tr&gt;</span>
<span class="x">            &lt;/thead&gt;</span>
<span class="x">            &lt;tbody class=&quot;invoice-item-container&quot;&gt;</span>
<span class="x">            @php</span>
<span class="x">                $i = 1;</span>
<span class="x">            @endphp</span>
<span class="x">            @foreach($invoice-&gt;invoiceItems as $invoiceItem)</span>
<span class="x">                &lt;tr class=&quot;tax-tr&quot;&gt;</span>
<span class="x">                    &lt;td class=&quot;text-center item-number align-center&quot;&gt;{{ $i++ }}&lt;/td&gt;</span>
<span class="x">                    &lt;td class=&quot;table__item-desc w-25&quot;&gt;</span>
<span class="x">                        {{ Form::select(&#39;product_id[]&#39;, $products, isset($invoiceItem-&gt;product_id)?$invoiceItem-&gt;product_id:$invoiceItem-&gt;product_name??[], [&#39;class&#39; =&gt; &#39;form-select productId product io-select2&#39;, &#39;required&#39;, &#39;placeholder&#39;=&gt;&#39;Select Product or Enter free text&#39;, &#39;data-control&#39; =&gt; &#39;select2&#39;]) }}</span>
<span class="x">                        {{ Form::hidden(&#39;id[]&#39;, $invoiceItem-&gt;id) }}</span>
<span class="x">                    &lt;/td&gt;</span>
<span class="x">                    &lt;td class=&quot;table__qty&quot;&gt;</span>
<span class="x">                        {{ Form::number(&#39;quantity[]&#39;, number_format($invoiceItem-&gt;quantity,2), [&#39;class&#39; =&gt; &#39;form-control qty &#39; ,&#39;id&#39;=&gt;&#39;qty&#39;,&#39;required&#39;, &#39;type&#39; =&gt; &#39;number&#39;, &quot;min&quot; =&gt; &#39;0&#39;,&#39;step&#39;=&gt;&#39;.01&#39;,&#39;oninput&#39;=&gt;&quot;validity.valid||(value=value.replace(/[e\+\-]/gi,&#39;&#39;))&quot;]) }}</span>
<span class="x">                    &lt;/td&gt;</span>
<span class="x">                    &lt;td&gt;</span>
<span class="x">                        {{ Form::number(&#39;price[]&#39;, $invoiceItem-&gt;price, [&#39;class&#39; =&gt; &#39;form-control price-input price &#39;,&#39;oninput&#39;=&gt;&quot;validity.valid||(value=value.replace(/[e\+\-]/gi,&#39;&#39;))&quot;,&#39;min&#39;=&gt;&#39;0&#39;,&#39;step&#39;=&gt;&#39;.01&#39;,&#39;required&#39;,&#39;onKeyPress&#39;=&gt;&#39;if(this.value.length==8) return false;&#39;]) }}</span>
<span class="x">                    &lt;/td&gt;</span>
<span class="x">                    &lt;td&gt;</span>
<span class="x">                        &lt;select name=&quot;tax[]&quot; class=&#39;form-select  fw-bold tax io-select2&#39;</span>
<span class="x">                                data-control=&#39;select2&#39; multiple=&quot;multiple&quot;&gt;</span>
<span class="x">                            @foreach($taxes as $tax)</span>
<span class="x">                                @if(empty($selectedTaxes))</span>
<span class="x">                                    &lt;option value=&quot;{{ $tax-&gt;value }}&quot;</span>
<span class="x">                                            data-id=&quot;{{ $tax-&gt;id }}&quot;&gt;</span>
<span class="x">                                        {{ $tax-&gt;name }}</span>
<span class="x">                                    &lt;/option&gt;</span>
<span class="x">                                @elseif(in_array($tax-&gt;id, $selectedTaxes[$invoiceItem-&gt;id]))</span>
<span class="x">                                    &lt;option value=&quot;{{ $tax-&gt;value }}&quot;</span>
<span class="x">                                            {{ (in_array($tax-&gt;id, $selectedTaxes[$invoiceItem-&gt;id]) &amp;&amp; in_array($tax-&gt;id, $selectedTaxes[$invoiceItem-&gt;id])) ? &#39;selected&#39; : &#39;&#39; }}</span>
<span class="x">                                            data-id=&quot;{{ $tax-&gt;id }}&quot;&gt;</span>
<span class="x">                                        {{ $tax-&gt;name }}</span>
<span class="x">                                    &lt;/option&gt;</span>
<span class="x">                                @else</span>
<span class="x">                                    &lt;option value=&quot;{{ $tax-&gt;value }}&quot;</span>
<span class="x">                                            data-id=&quot;{{ $tax-&gt;id }}&quot;&gt;</span>
<span class="x">                                        {{ $tax-&gt;name }}</span>
<span class="x">                                    &lt;/option&gt;</span>
<span class="x">                                @endif</span>
<span class="x">                            @endforeach</span>
<span class="x">                        &lt;/select&gt;</span>
<span class="x">                    &lt;/td&gt;</span>
<span class="x">                    &lt;td class=&quot;text-end item-total pt-8 text-nowrap&quot;&gt;</span>
<span class="x">                        {{ number_format($invoiceItem-&gt;total, 2) }}</span>
<span class="x">                    &lt;/td&gt;</span>
<span class="x">                    &lt;td class=&quot;text-end&quot;&gt;</span>
<span class="x">                        &lt;button type=&quot;button&quot; title=&quot;Delete&quot;</span>
<span class="x">                                class=&quot;btn btn-icon fs-3 text-danger btn-active-color-danger delete-invoice-item&quot;&gt;</span>
<span class="x">                            &lt;i class=&quot;fa-solid fa-trash&quot;&gt;&lt;/i&gt;</span>
<span class="x">                        &lt;/button&gt;</span>
<span class="x">                    &lt;/td&gt;</span>
<span class="x">                &lt;/tr&gt;</span>
<span class="x">            @endforeach</span>
<span class="x">            &lt;/tbody&gt;</span>
<span class="x">        &lt;/table&gt;</span>
<span class="x">    &lt;/div&gt;</span>
<span class="x">    &lt;div class=&quot;row&quot;&gt;</span>
<span class="x">        &lt;div class=&quot;col-lg-7 col-sm-12 mt-2 mt-lg-0 align-right-for-full-screen&quot;&gt;</span>
<span class="x">            &lt;div class=&quot;mb-2 col-xl-5 col-lg-8 col-sm-12&quot;&gt;</span>
<span class="x">                {{ Form::label(&#39;discount&#39;, __(&#39;messages.invoice.discount&#39;).(&#39;:&#39;), [&#39;class&#39; =&gt; &#39;form-label mb-1&#39;]) }}</span>
<span class="x">                &lt;div class=&quot;input-group&quot;&gt;</span>
<span class="x">                    {{ Form::number(&#39;discount&#39;,  isset($invoice) ? $invoice-&gt;discount : 0, [&#39;id&#39;=&gt;&#39;discount&#39;,&#39;class&#39; =&gt; &#39;form-control &#39;,&#39;oninput&#39;=&gt;&quot;validity.valid||(value=value.replace(/[e\+\-]/gi,&#39;&#39;))&quot;,&#39;min&#39;=&gt;&#39;0&#39;,&#39;value&#39;=&gt;&#39;0&#39;,&#39;step&#39;=&gt;&#39;.01&#39;,&#39;pattern&#39;=&gt;&quot;^\d*(\.\d{0,2})?$&quot;]) }}</span>
<span class="x">                    &lt;div class=&quot;input-group-append&quot; style=&quot;width: 210px !important;&quot;&gt;</span>
<span class="x">                        {{ Form::select(&#39;discount_type&#39;, $discount_type, isset($invoice) ? $invoice-&gt;discount_type : 0, [&#39;class&#39; =&gt;&#39;form-select&#39;, &#39;id&#39; =&gt; &#39;discountType&#39;, &#39;data-control&#39; =&gt;&#39;select2&#39;]) }}</span>
<span class="x">                    &lt;/div&gt;</span>
<span class="x">                &lt;/div&gt;</span>
<span class="x">            &lt;/div&gt;</span>
<span class="x">            &lt;div class=&quot;mb-2 col-xl-5 col-lg-8 col-sm-12&quot;&gt;</span>
<span class="x">                {{ Form::label(&#39;taxes&#39;, __(&#39;messages.invoice.tax&#39;).(&#39;:&#39;),[&#39;class&#39; =&gt; &#39;form-label mb-1&#39;]) }}</span>
<span class="x">                &lt;select name=&quot;taxes[]&quot; class=&#39;form-select io-select2 fw-bold invoice-taxes&#39;</span>
<span class="x">                        data-control=&#39;select2&#39; multiple=&quot;multiple&quot;&gt;</span>
<span class="x">                    @foreach($taxes as $tax)</span>
<span class="x">                        &lt;option value=&quot;{{ $tax-&gt;id }}&quot; data-tax=&quot;{{ $tax-&gt;value }}&quot; {{ in_array($tax-&gt;id, $selectedInvoiceTaxes) ? &#39;selected&#39; : &#39;&#39; }}&gt;{{ $tax-&gt;name }}&lt;/option&gt;</span>
<span class="x">                    @endforeach</span>
<span class="x">                &lt;/select&gt;</span>
<span class="x">            &lt;/div&gt;</span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">        &lt;div class=&quot;col-xxl-3 col-lg-5 col-md-6 ms-md-auto mt-4 mb-lg-10 mb-6&quot;&gt;</span>
<span class="x">            &lt;div class=&quot;border-top&quot;&gt;</span>
<span class="x">                &lt;table class=&quot;table table-borderless box-shadow-none mb-0 mt-5&quot;&gt;</span>
<span class="x">                    &lt;tbody&gt;</span>
<span class="x">                    &lt;tr&gt;</span>
<span class="x">                        &lt;td class=&quot;ps-0&quot;&gt;{{ __(&#39;messages.invoice.sub_total&#39;).(&#39;:&#39;) }}&lt;/td&gt;</span>
<span class="x">                        &lt;td class=&quot;text-gray-900 text-end pe-0&quot;&gt;</span>
<span class="x">                            @if(!getSettingValue(&#39;currency_after_amount&#39;))&lt;span</span>
<span class="x">                                    class=&quot;invoice-selected-currency&quot;&gt;{{ getInvoiceCurrencyIcon($invoice-&gt;currency_id)  }}&lt;/span&gt;@endif</span>
<span class="x">                            &lt;span id=&quot;total&quot; class=&quot;price&quot;&gt;</span>
<span class="x">                                    {{ isset($invoice) ? number_format($invoice-&gt;amount,2) : 0 }}</span>
<span class="x">                            &lt;/span&gt;</span>
<span class="x">                            @if(getSettingValue(&#39;currency_after_amount&#39;))&lt;span</span>
<span class="x">                                    class=&quot;invoice-selected-currency&quot;&gt;{{ getInvoiceCurrencyIcon($invoice-&gt;currency_id)  }}&lt;/span&gt;@endif</span>
<span class="x">                        &lt;/td&gt;</span>
<span class="x">                    &lt;/tr&gt;</span>
<span class="x">                    &lt;tr&gt;</span>
<span class="x">                        &lt;td class=&quot;ps-0&quot;&gt;{{ __(&#39;messages.invoice.discount&#39;).(&#39;:&#39;) }}&lt;/td&gt;</span>
<span class="x">                        &lt;td class=&quot;text-gray-900 text-end pe-0&quot;&gt;</span>
<span class="x">                            @if(!getSettingValue(&#39;currency_after_amount&#39;))&lt;span</span>
<span class="x">                                    class=&quot;invoice-selected-currency&quot;&gt;{{ getInvoiceCurrencyIcon($invoice-&gt;currency_id)  }}&lt;/span&gt;@endif</span>
<span class="x">                            &lt;span id=&quot;discountAmount&quot;&gt;</span>
<span class="x">                                @if(isset($invoice) &amp;&amp; $invoice-&gt;discount_type == \App\Models\Invoice::FIXED)</span>
<span class="x">                                    {{ $invoice-&gt;discount ?? 0 }}</span>
<span class="x">                                @else</span>
<span class="x">                                    {{ isset($invoice) ? number_format($invoice-&gt;amount * $invoice-&gt;discount / 100,2) : 0 }}</span>
<span class="x">                                @endif</span>
<span class="x">                            &lt;/span&gt;</span>
<span class="x">                            @if(getSettingValue(&#39;currency_after_amount&#39;))&lt;span</span>
<span class="x">                                    class=&quot;invoice-selected-currency&quot;&gt;{{ getInvoiceCurrencyIcon($invoice-&gt;currency_id)  }}&lt;/span&gt;@endif</span>
<span class="x">                        &lt;/td&gt;</span>
<span class="x">                    &lt;/tr&gt;</span>
<span class="x">                    &lt;tr&gt;</span>
<span class="x">                        &lt;td class=&quot;ps-0&quot;&gt;{{ __(&#39;messages.invoice.total_tax&#39;).(&#39;:&#39;) }}&lt;/td&gt;</span>
<span class="x">                        &lt;td class=&quot;text-gray-900 text-end pe-0&quot;&gt;</span>
<span class="x">                            @if(!getSettingValue(&#39;currency_after_amount&#39;))&lt;span</span>
<span class="x">                                    class=&quot;invoice-selected-currency&quot;&gt;{{ getInvoiceCurrencyIcon($invoice-&gt;currency_id)  }}&lt;/span&gt;@endif</span>
<span class="x">                            &lt;span id=&quot;totalTax&quot;&gt;</span>
<span class="x">                                    0</span>
<span class="x">                            &lt;/span&gt;</span>
<span class="x">                            @if(getSettingValue(&#39;currency_after_amount&#39;))&lt;span</span>
<span class="x">                                    class=&quot;invoice-selected-currency&quot;&gt;{{ getInvoiceCurrencyIcon($invoice-&gt;currency_id)  }}&lt;/span&gt;@endif</span>
<span class="x">                        &lt;/td&gt;</span>
<span class="x">                    &lt;/tr&gt;</span>
<span class="x">                    &lt;tr&gt;</span>
<span class="x">                        &lt;td class=&quot;ps-0&quot;&gt;{{ __(&#39;messages.invoice.total&#39;).(&#39;:&#39;) }}&lt;/td&gt;</span>
<span class="x">                        &lt;td class=&quot;text-gray-900 text-end pe-0&quot;&gt;</span>
<span class="x">                            @if(!getSettingValue(&#39;currency_after_amount&#39;))&lt;span</span>
<span class="x">                                    class=&quot;invoice-selected-currency&quot;&gt;{{ getInvoiceCurrencyIcon($invoice-&gt;currency_id) }}&lt;/span&gt;@endif</span>
<span class="x">                            &lt;span id=&quot;finalAmount&quot;&gt;</span>
<span class="x">                                    {{ isset($invoice) ? number_format($invoice-&gt;amount - ($invoice-&gt;amount * $invoice-&gt;discount / 100),2) : 0 }}</span>
<span class="x">                                &lt;/span&gt;</span>
<span class="x">                            @if(getSettingValue(&#39;currency_after_amount&#39;))&lt;span</span>
<span class="x">                                    class=&quot;invoice-selected-currency&quot;&gt;{{ getInvoiceCurrencyIcon($invoice-&gt;currency_id) }}&lt;/span&gt;@endif</span>
<span class="x">                        &lt;/td&gt;</span>
<span class="x">                    &lt;/tr&gt;</span>
<span class="x">                    &lt;/tbody&gt;</span>
<span class="x">                &lt;/table&gt;</span>
<span class="x">            &lt;/div&gt;</span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">    &lt;/div&gt;</span>
<span class="x">    &lt;br&gt;</span>
<span class="x">    &lt;div class=&quot;row justify-content-left&quot;&gt;</span>
<span class="x">        &lt;div class=&quot;col-lg-12 col-md-12 col-sm-12 end justify-content-left mb-sm-0 mb-5&quot;&gt;</span>
<span class="x">            &lt;button type=&quot;button&quot; class=&quot;btn btn-primary note&quot; id=&quot;addNote&quot;&gt;</span>
<span class="x">                &lt;i class=&quot;fas fa-plus&quot;&gt;&lt;/i&gt; {{ __(&#39;messages.invoice.add_note_term&#39;) }}</span>
<span class="x">            &lt;/button&gt;</span>
<span class="x">            &lt;button type=&quot;button&quot; class=&quot;btn btn-danger note&quot; id=&quot;removeNote&quot;&gt;</span>
<span class="x">                &lt;i class=&quot;fas fa-minus&quot;&gt;&lt;/i&gt; {{ __(&#39;messages.invoice.remove_note_term&#39;) }}</span>
<span class="x">            &lt;/button&gt;</span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">        &lt;div class=&quot;col-lg-6 mb-0 mb-sm-5 mt-0 mt-sm-5&quot; id=&quot;noteAdd&quot;&gt;</span>
<span class="x">            {{ Form::label(&#39;note&#39;, __(&#39;messages.invoice.note&#39;).(&#39;:&#39;),[&#39;class&#39; =&gt; &#39;form-label fs-6 mb-3&#39;]) }}</span>
<span class="x">            {{ Form::textarea(&#39;note&#39;,isset($invoice) ? $invoice-&gt;note : null,[&#39;class&#39;=&gt;&#39;form-control&#39;,&#39;id&#39;=&gt;&#39;note&#39;,&#39;rows&#39;=&gt;&#39;5&#39;]) }}</span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">        &lt;div class=&quot;col-lg-6 mt-5 mb-5&quot; id=&quot;termRemove&quot;&gt;</span>
<span class="x">            {{ Form::label(&#39;term&#39;, __(&#39;messages.invoice.terms&#39;).(&#39;:&#39;),[&#39;class&#39; =&gt; &#39;form-label fs-6 mb-3&#39;]) }}</span>
<span class="x">            {{ Form::textarea(&#39;term&#39;,isset($invoice) ? $invoice-&gt;term : null,[&#39;class&#39;=&gt;&#39;form-control&#39;,&#39;id&#39;=&gt;&#39;term&#39;,&#39;rows&#39;=&gt;&#39;5&#39;]) }}</span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">    &lt;/div&gt;</span>
<span class="x">&lt;/div&gt;</span>
<span class="x">&lt;!-- Total Amount Field --&gt;</span>
<span class="x">{{ Form::hidden(&#39;amount&#39;, isset($invoice) ? number_format($invoice-&gt;amount - ($invoice-&gt;amount * $invoice-&gt;discount / 100),2) : 0, [&#39;class&#39; =&gt; &#39;form-control&#39;, &#39;id&#39; =&gt; &#39;total_amount&#39;]) }}</span>

<span class="x">&lt;!-- Final Amount Field --&gt;</span>
<span class="x">{{ Form::hidden(&#39;final_amount&#39;,isset($invoice) ? $invoice-&gt;final_amount : 0, [&#39;class&#39; =&gt; &#39;form-control&#39;, &#39;id&#39; =&gt; &#39;finalTotalAmt&#39;]) }}</span>

<span class="x">&lt;!-- Submit Field --&gt;</span>
<span class="x">&lt;div class=&quot;float-end&quot;&gt;</span>
<span class="x">    &lt;div class=&quot;form-group col-sm-12&quot;&gt;</span>
<span class="x">        &lt;button type=&quot;button&quot; name=&quot;save&quot; class=&quot;btn btn-primary mx-1 ms-ms-3 mb-3 mb-sm-0&quot; id=&quot;editSave&quot;</span>
<span class="x">                data-status=&quot;0&quot;</span>
<span class="x">                value=&quot;0&quot;&gt;{{ __(&#39;messages.common.save&#39;) }}</span>
<span class="x">        &lt;/button&gt;</span>
<span class="x">        @if($invoice-&gt;status == \App\Models\Invoice::DRAFT)</span>
<span class="x">            &lt;button type=&quot;button&quot; name=&quot;save_send&quot; class=&quot;btn btn-primary mx-1 ms-ms-3 mb-3 mb-sm-0&quot;</span>
<span class="x">                    id=&quot;editSaveAndSend&quot; data-status=&quot;1&quot;</span>
<span class="x">                    value=&quot;1&quot;&gt;{{ __(&#39;messages.common.save_send&#39;) }}</span>
<span class="x">            &lt;/button&gt;</span>
<span class="x">        @endif</span>
<span class="x">        &lt;a href=&quot;{{ route(&#39;invoices.index&#39;) }}&quot;</span>
<span class="x">           class=&quot;btn btn-secondary btn-active-light-primary&quot;&gt;{{ __(&#39;messages.common.cancel&#39;) }}&lt;/a&gt;</span>
<span class="x">    &lt;/div&gt;</span>
<span class="x">&lt;/div&gt;</span>
</code></pre></div>
<p>This code represents the form and associated elements for editing an invoice in our application's Blade view. It includes various form fields and controls for modifying the invoice's details. Here's a breakdown of the code:</p>
<ol>
<li>
<p><strong>Client Selection Section</strong>:</p>
</li>
<li>
<p>The client selection section allows you to choose a client for the invoice.</p>
</li>
<li>Depending on the invoice's status (Draft or not), it displays either a client selection dropdown or the selected client's name as plain text.</li>
<li>If it's a draft invoice, it displays a dropdown (<code>Form::select</code>) for selecting a client. Otherwise, it shows the selected client's name as text.</li>
<li>
<p>An <code>input</code> element with the name "client_id" is used to store the selected client's ID.</p>
</li>
<li>
<p><strong>Invoice Information Section</strong>:</p>
</li>
<li>
<p>This section displays the invoice number and allows the user to change the invoice's status.</p>
</li>
<li>It shows the invoice number as a header along with an <code>input</code> element (hidden) for storing the invoice ID.</li>
<li>
<p>A dropdown (<code>Form::select</code>) is used for selecting the invoice's status.</p>
</li>
<li>
<p><strong>Invoice Date, Due Date, and Other Information Section</strong>:</p>
</li>
<li>
<p>This part of the form contains various input fields for editing invoice-related details such as invoice date, due date, template selection, currency, and recurring status.</p>
</li>
<li>
<p>It also includes an input for specifying the recurring cycle (the number of days for recurring invoices) if the recurring status is enabled.</p>
</li>
<li>
<p><strong>Invoice Item Table</strong>:</p>
</li>
<li>
<p>The code includes a table for listing invoice items (products or services).</p>
</li>
<li>Each row in the table represents an invoice item and includes fields for selecting products, specifying quantities, prices, taxes, and actions (e.g., delete).</li>
<li>The table is populated with data from the existing invoice's items.</li>
<li>
<p>JavaScript is used to handle actions like adding and deleting items.</p>
</li>
<li>
<p><strong>Discount and Tax Information</strong>:</p>
</li>
<li>
<p>This section allows the user to specify a discount amount or percentage and select taxes.</p>
</li>
<li>The discount input is a <code>Form::number</code> field with options for specifying the discount type.</li>
<li>
<p>A multi-select dropdown is used for selecting taxes associated with the invoice.</p>
</li>
<li>
<p><strong>Summary and Total Amount Section</strong>:</p>
</li>
<li>
<p>This section displays a summary of the invoice, including sub-total, discount amount, total tax, and the final total amount.</p>
</li>
<li>
<p>These amounts are calculated based on the entered data and any discounts or taxes selected.</p>
</li>
<li>
<p><strong>Note and Terms Section</strong>:</p>
</li>
<li>
<p>Users can add notes and terms related to the invoice.</p>
</li>
<li>Buttons are provided for adding or removing notes.</li>
<li>
<p>Textareas are used for entering and displaying notes and terms.</p>
</li>
<li>
<p><strong>Hidden Fields</strong>:</p>
</li>
<li>
<p>Several hidden fields store calculated amounts and other data for use when saving the invoice.</p>
</li>
<li>
<p>These hidden fields include the total amount, final total amount, and other metadata.</p>
</li>
<li>
<p><strong>Form Submission Buttons</strong>:</p>
</li>
<li>Buttons for saving and optionally sending the invoice are included at the bottom of the form.</li>
<li>The button labels depend on the invoice's status. If it's a draft invoice, there is an option to "Save &amp; Send."</li>
</ol>
<p>Overall, this Blade view provides a comprehensive form for editing invoice details, including client selection, invoice item management, tax and discount configuration, and additional notes and terms. The form handles both the display of existing invoice data and the submission of modified data to update the invoice.</p>
<h3 id="show-invoice">Show invoice</h3>
<p>The view of the 'show invoice' page located in <strong>ressources&gt;views&gt;show&gt;show.blade.php</strong>.</p>
<div class="highlight"><pre><span></span><code><span class="x">@extends(&#39;layouts.app&#39;)</span>
<span class="x">@section(&#39;title&#39;)</span>
<span class="x">    {{ __(&#39;messages.invoice.invoice_details&#39;)}}</span>
<span class="x">@endsection</span>
<span class="x">@section(&#39;header_toolbar&#39;)</span>
<span class="x">    &lt;div class=&quot;container-fluid&quot;&gt;</span>
<span class="x">        &lt;div class=&quot;d-md-flex align-items-center justify-content-between mb-5&quot;&gt;</span>
<span class="x">            &lt;h1 class=&quot;mb-0&quot;&gt;@yield(&#39;title&#39;)&lt;/h1&gt;</span>
<span class="x">            &lt;div class=&quot;text-end mt-4 mt-md-0&quot;&gt;</span>
<span class="x">                    &lt;a href=&quot;{{ route(&#39;invoices.edit&#39;, [&#39;invoice&#39; =&gt; $invoice-&gt;id]) }}&quot; data-turbo=&quot;false&quot;</span>
<span class="x">                       class=&quot;btn btn-primary me-4&quot;&gt;{{__(&#39;messages.common.edit&#39;)}}&lt;/a&gt;</span>
<span class="x">                &lt;a href=&quot;{{ url()-&gt;previous() }}&quot;</span>
<span class="x">                   class=&quot;btn btn-outline-primary&quot;&gt;{{ __(&#39;messages.common.back&#39;) }}&lt;/a&gt;</span>
<span class="x">            &lt;/div&gt;</span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">    &lt;/div&gt;</span>
<span class="x">@endsection</span>
<span class="x">@section(&#39;content&#39;)</span>
<span class="x">    &lt;div class=&quot;container-fluid&quot;&gt;</span>
<span class="x">        &lt;div class=&quot;d-flex flex-column&quot;&gt;</span>
<span class="x">            @include(&#39;flash::message&#39;)</span>
<span class="x">            @include(&#39;invoices.show_fields&#39;,[&#39;isPublicView&#39;=&gt; true])</span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">    &lt;/div&gt;</span>
<span class="x">    @include(&#39;transactions.payment-notes-modal&#39;)</span>
<span class="x">@endsection</span>
<span class="x">@section(&#39;scripts&#39;)</span>
<span class="x">    &lt;script src=&quot;{{ asset(&#39;assets/js/invoice/invoice_payment_history.js&#39;) }}&quot;&gt;&lt;/script&gt;</span>
<span class="x">    &lt;script src=&quot;{{ asset(&#39;assets/js/invoice/invoice_send.js&#39;) }}&quot;&gt;&lt;/script&gt;</span>
<span class="x">@endsection</span>
</code></pre></div>
<p>This Blade view represents the display of invoice details our application. Here's a breakdown of the code:</p>
<ol>
<li>
<p><strong>Page Title</strong>:</p>
</li>
<li>
<p>Sets the title of the page to "Invoice Details" or a localized equivalent.</p>
</li>
<li>
<p><strong>Header Toolbar</strong>:</p>
</li>
<li>
<p>The header toolbar contains navigation links and buttons.</p>
</li>
<li>It includes a "Back" button that allows the user to navigate back to the previous page.</li>
<li>
<p>If the <code>$invoice</code> is editable (e.g., in a draft status), it also includes an "Edit" button, linking to the invoice editing page.</p>
</li>
<li>
<p><strong>Content Section</strong>:</p>
</li>
<li>
<p>The main content section of the page is contained within a container (<code>&lt;div class="container-fluid"&gt;</code>).</p>
</li>
<li>It includes a flex column layout and displays any flash messages (notifications) that may be present.</li>
<li>
<p>The <code>@include('invoices.show_fields',['isPublicView'=&gt; true])</code> directive is used to include a partial view called "show_fields," which contains the actual invoice details to be displayed.</p>
</li>
<li>
<p><strong>Payment Notes Modal</strong>:</p>
</li>
<li>
<p>There's an <code>@include</code> directive for including a modal view named "payment-notes-modal." This modal is used to display additional payment-related notes or information.</p>
</li>
<li>
<p><strong>Scripts</strong>:</p>
</li>
<li>JavaScript files are included at the end of the view using the <code>@section('scripts')</code> directive.</li>
<li>Two JavaScript files are included: "invoice_payment_history.js" and "invoice_send.js." These scripts are responsible for handling payment history and invoice sending functionality.</li>
</ol>
<p>Overall, this Blade view provides a user-friendly display of invoice details, including the ability to navigate back to the previous page and, if applicable, edit the invoice. It also includes scripts for enhancing the user experience by handling payment history and sending functionality.</p>
<p><strong>invoices.Show_fields.blade.php :</strong></p>
<div class="highlight"><pre><span></span><code><span class="x">@php</span>
<span class="x">    $auth =  Auth::check();</span>
<span class="x">    $itemTaxesAmount = $invoice-&gt;amount + array_sum($totalTax);</span>
<span class="x">    $invoiceTaxesAmount = ($itemTaxesAmount * $invoice-&gt;invoiceTaxes-&gt;sum(&#39;value&#39;) / 100);</span>
<span class="x">@endphp</span>
<span class="x">&lt;div&gt;</span>
<span class="x">    @if($auth &amp;&amp; $isPublicView)</span>
<span class="x">        &lt;div class=&quot;d-flex overflow-auto h-55px&quot;&gt;</span>
<span class="x">            &lt;ul class=&quot;nav nav-tabs mb-5 pb-1 overflow-auto flex-nowrap text-nowrap&quot;&gt;</span>
<span class="x">                &lt;li class=&quot;nav-item position-relative me-7 mb-3&quot; role=&quot;presentation&quot;&gt;</span>
<span class="x">                    &lt;button class=&quot;nav-link active p-0&quot; id=&quot;overview-tab&quot; data-bs-toggle=&quot;tab&quot;</span>
<span class="x">                            data-bs-target=&quot;#overview&quot;</span>
<span class="x">                            type=&quot;button&quot; role=&quot;tab&quot; aria-controls=&quot;overview&quot; aria-selected=&quot;true&quot;&gt;</span>
<span class="x">                        {{ __(&#39;messages.invoice.overview&#39;) }}</span>
<span class="x">                    &lt;/button&gt;</span>
<span class="x">                &lt;/li&gt;</span>
<span class="x">                @if($invoice-&gt;parentInvoice)</span>
<span class="x">                    &lt;li class=&quot;nav-item position-relative me-7 mb-3&quot; role=&quot;presentation&quot;&gt;</span>
<span class="x">                        &lt;button class=&quot;nav-link p-0&quot; id=&quot;parentInvoices-tab&quot; data-bs-toggle=&quot;tab&quot;</span>
<span class="x">                                data-bs-target=&quot;#parentInvoiceDetail&quot;</span>
<span class="x">                                type=&quot;button&quot; role=&quot;tab&quot; aria-controls=&quot;parentInvoiceDetail&quot; aria-selected=&quot;false&quot;&gt;</span>
<span class="x">                            {{ __(&#39;messages.invoice.parent_invoice&#39;) }}</span>
<span class="x">                        &lt;/button&gt;</span>
<span class="x">                    &lt;/li&gt;</span>
<span class="x">                @endif</span>
<span class="x">                &lt;li class=&quot;nav-item position-relative me-7 mb-3&quot; role=&quot;presentation&quot;&gt;</span>
<span class="x">                    &lt;button class=&quot;nav-link p-0&quot; id=&quot;note_terms-tab&quot; data-bs-toggle=&quot;tab&quot; data-bs-target=&quot;#note_terms&quot;</span>
<span class="x">                            type=&quot;button&quot; role=&quot;tab&quot; aria-controls=&quot;note_terms&quot; aria-selected=&quot;false&quot;&gt;</span>
<span class="x">                        {{ __(&#39;messages.invoice.note_terms&#39;) }}</span>
<span class="x">                    &lt;/button&gt;</span>
<span class="x">                &lt;/li&gt;</span>
<span class="x">                &lt;li class=&quot;nav-item position-relative me-7 mb-3&quot; role=&quot;presentation&quot;&gt;</span>
<span class="x">                    &lt;button class=&quot;nav-link p-0&quot; id=&quot;paymentHistory-tab&quot; data-bs-toggle=&quot;tab&quot;</span>
<span class="x">                            data-bs-target=&quot;#paymentHistory&quot;</span>
<span class="x">                            type=&quot;button&quot; role=&quot;tab&quot; aria-controls=&quot;paymentHistory&quot; aria-selected=&quot;false&quot;&gt;</span>
<span class="x">                        {{ __(&#39;messages.invoice.payment_history&#39;) }}</span>
<span class="x">                    &lt;/button&gt;</span>
<span class="x">                &lt;/li&gt;</span>
<span class="x">                @if($invoice-&gt;child_invoices_count &gt; 0)</span>
<span class="x">                    &lt;li class=&quot;nav-item position-relative me-7 mb-3&quot; role=&quot;presentation&quot;&gt;</span>
<span class="x">                        &lt;button class=&quot;nav-link p-0&quot; id=&quot;recurringInvoices-tab&quot; data-bs-toggle=&quot;tab&quot;</span>
<span class="x">                                data-bs-target=&quot;#recurringInvoices&quot;</span>
<span class="x">                                type=&quot;button&quot; role=&quot;tab&quot; aria-controls=&quot;recurringInvoices&quot; aria-selected=&quot;false&quot;&gt;</span>
<span class="x">                            {{ __(&#39;messages.invoice.recurring_invoices&#39;) }}</span>
<span class="x">                        &lt;/button&gt;</span>
<span class="x">                    &lt;/li&gt;</span>
<span class="x">                @endif</span>
<span class="x">            &lt;/ul&gt;</span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">    @endif</span>
<span class="x">    &lt;div class=&quot;tab-content&quot; id=&quot;myTabContent&quot;&gt;</span>
<span class="x">        &lt;div class=&quot;tab-pane fade show active&quot; id=&quot;overview&quot; role=&quot;tabpanel&quot;&gt;</span>
<span class="x">            &lt;div class=&quot;card&quot;&gt;</span>
<span class="x">                &lt;div class=&quot;d-flex flex-column&quot;&gt;</span>
<span class="x">                    &lt;div class=&quot;card-body&quot;&gt;</span>
<span class="x">                        &lt;div class=&quot;row&quot;&gt;</span>
<span class="x">                            &lt;div class=&quot;col-xxl-9&quot;&gt;</span>
<span class="x">                                &lt;div class=&quot;row&quot;&gt;</span>
<span class="x">                                    &lt;div class=&quot;col-lg-4 col-md-6&quot;&gt;</span>
<span class="x">                                        &lt;div class=&quot;d-flex mb-md-10 mb-5&quot;&gt;</span>
<span class="x">                                            &lt;div class=&quot;image image-circle image-lg-small width-100px&quot;&gt;</span>
<span class="x">                                                &lt;img src=&quot;{{ getLogoUrl() }}&quot; alt=&quot;user&quot; class=&quot;object-contain&quot;&gt;</span>
<span class="x">                                            &lt;/div&gt;</span>
<span class="x">                                            &lt;h3 class=&quot;ps-7&quot;&gt;{{ __(&#39;messages.invoice.invoice&#39;) }}</span>
<span class="x">                                                #{{ $invoice-&gt;invoice_id }}</span>
<span class="x">                                            &lt;/h3&gt;</span>
<span class="x">                                        &lt;/div&gt;</span>
<span class="x">                                    &lt;/div&gt;</span>
<span class="x">                                    &lt;div class=&quot;col-lg-3 col-md-3 col-6&quot;&gt;</span>
<span class="x">                                        &lt;div class=&quot;d-flex flex-column mb-md-10 mb-5 mt-3 mt-md-0&quot;&gt;</span>
<span class="x">                                            &lt;label for=&quot;name&quot;</span>
<span class="x">                                                   class=&quot;pb-2 fs-4 text-gray-600&quot;&gt;{{ __(&#39;messages.invoice.invoice_date&#39;).&#39;:&#39; }}&lt;/label&gt;</span>
<span class="x">                                            &lt;span class=&quot;fs-4 text-gray-800&quot;&gt;{{ \Carbon\Carbon::parse($invoice-&gt;invoice_date)-&gt;translatedFormat(currentDateFormat()) }}&lt;/span&gt;</span>
<span class="x">                                        &lt;/div&gt;</span>
<span class="x">                                    &lt;/div&gt;</span>
<span class="x">                                    &lt;div class=&quot;col-lg-3 col-md-3 col-6&quot;&gt;</span>
<span class="x">                                        &lt;div class=&quot;d-flex flex-column mb-md-10 mb-5 mt-3 mt-md-0&quot;&gt;</span>
<span class="x">                                            &lt;label for=&quot;name&quot;</span>
<span class="x">                                                   class=&quot;pb-2 fs-4 text-gray-600&quot;&gt;{{ __(&#39;messages.invoice.due_date&#39;).&#39;:&#39; }}&lt;/label&gt;</span>
<span class="x">                                            &lt;span class=&quot;fs-4 text-gray-800&quot;&gt;{{ \Carbon\Carbon::parse($invoice-&gt;due_date)-&gt;translatedFormat(currentDateFormat()) }}&lt;/span&gt;</span>
<span class="x">                                        &lt;/div&gt;</span>
<span class="x">                                    &lt;/div&gt;</span>
<span class="x">                                    &lt;div class=&quot;col-md-2 col-6 mb-3 mb-sm-0&quot;&gt;</span>
<span class="x">                                        @if($isPublicView)</span>
<span class="x">                                            &lt;a target=&quot;_blank&quot;</span>
<span class="x">                                               href=&quot;{{ route(&#39;invoices.pdf&#39;,[&#39;invoice&#39; =&gt; $invoice-&gt;id]) }}&quot;</span>
<span class="x">                                               class=&quot;btn btn-sm btn-success text-white&quot;&gt;{{ __(&#39;messages.invoice.print_invoice&#39;) }}&lt;/a&gt;</span>
<span class="x">                                        @else</span>
<span class="x">                                            &lt;a target=&quot;_blank&quot;</span>
<span class="x">                                               href=&quot;{{ route(&#39;public-view-invoice.pdf&#39;,[&#39;invoice&#39; =&gt; $invoice-&gt;invoice_id]) }}&quot;</span>
<span class="x">                                               class=&quot;btn btn-sm btn-success text-white&quot;&gt;{{ __(&#39;messages.invoice.print_invoice&#39;) }}&lt;/a&gt;</span>
<span class="x">                                        @endif</span>
<span class="x">                                    &lt;/div&gt;</span>
<span class="x">                                    &lt;div class=&quot;col-lg-5 col-md-6&quot;&gt;</span>
<span class="x">                                        &lt;div class=&quot;d-flex flex-column mb-md-10 mb-5&quot;&gt;</span>
<span class="x">                                            &lt;label for=&quot;name&quot;</span>
<span class="x">                                                   class=&quot;pb-2 fs-4 text-gray-600&quot;&gt;{{ __(&#39;messages.invoice.issue_for&#39;).&#39;:&#39; }}&lt;/label&gt;</span>
<span class="x">                                            &lt;span class=&quot;fs-4 text-gray-800 mb-3&quot;&gt;{{ $invoice-&gt;client-&gt;user-&gt;full_name }}&lt;/span&gt;</span>
<span class="x">                                            &lt;p class=&quot;text-gray-700 fs-4 mb-0&quot;&gt;</span>
<span class="x">                                                @if(isset($invoice-&gt;client-&gt;address) &amp;&amp; !empty($invoice-&gt;client-&gt;address))</span>
<span class="x">                                                    {{ ucfirst($invoice-&gt;client-&gt;address) }}</span>
<span class="x">                                                @else</span>
<span class="x">                                                    {{ &quot;N/A&quot; }}</span>
<span class="x">                                                @endif</span>
<span class="x">                                            &lt;/p&gt;</span>
<span class="x">                                        &lt;/div&gt;</span>
<span class="x">                                    &lt;/div&gt;</span>
<span class="x">                                    &lt;div class=&quot;col-md-2 col-md-6&quot;&gt;</span>
<span class="x">                                        &lt;div class=&quot;d-flex flex-column mb-md-10 mb-5&quot;&gt;</span>
<span class="x">                                            &lt;label for=&quot;name&quot;</span>
<span class="x">                                                   class=&quot;pb-2 fs-4 text-gray-600&quot;&gt;{{ __(&#39;messages.invoice.issue_by&#39;).&#39;:&#39; }}&lt;/label&gt;</span>
<span class="x">                                            &lt;span class=&quot;fs-4 text-gray-800 mb-3&quot;&gt;{{ getAppName() }}&lt;/span&gt;</span>
<span class="x">                                            &lt;p class=&quot;text-gray-700 fs-4 mb-0&quot;&gt;</span>
<span class="x">                                                {!! getSettingValue(&#39;company_address&#39;) !!}&lt;/p&gt;</span>
<span class="x">                                        &lt;/div&gt;</span>
<span class="x">                                    &lt;/div&gt;</span>
<span class="x">                                    &lt;div class=&quot;col-12 table-responsive&quot;&gt;</span>
<span class="x">                                        &lt;table class=&quot;table table-striped box-shadow-none mt-4&quot;&gt;</span>
<span class="x">                                            &lt;thead&gt;</span>
<span class="x">                                            &lt;tr&gt;</span>
<span class="x">                                                &lt;th scope=&quot;col&quot;&gt;{{ __(&#39;messages.product.product&#39;) }}&lt;/th&gt;</span>
<span class="x">                                                &lt;th scope=&quot;col&quot;&gt;{{ __(&#39;messages.invoice.qty&#39;) }}&lt;/th&gt;</span>
<span class="x">                                                &lt;th scope=&quot;col&quot; class=&quot;text-end&quot;&gt;{{ __(&#39;messages.invoice.price&#39;) }}&lt;/th&gt;</span>
<span class="x">                                                &lt;th scope=&quot;col&quot;</span>
<span class="x">                                                    class=&quot;text-center&quot;&gt;{{ __(&#39;messages.invoice.tax&#39;).&#39; (in %)&#39; }}&lt;/th&gt;</span>
<span class="x">                                                &lt;th scope=&quot;col&quot;</span>
<span class="x">                                                    class=&quot;text-end&quot;&gt;{{ __(&#39;messages.invoice.amount&#39;) }}&lt;/th&gt;</span>
<span class="x">                                            &lt;/tr&gt;</span>
<span class="x">                                            &lt;/thead&gt;</span>
<span class="x">                                            &lt;tbody&gt;</span>
<span class="x">                                            @foreach($invoice-&gt;invoiceItems as $index =&gt; $invoiceItem)</span>
<span class="x">                                                &lt;tr&gt;</span>
<span class="x">                                                    &lt;td class=&quot;py-4&quot;&gt;{{ isset($invoiceItem-&gt;product-&gt;name)?$invoiceItem-&gt;product-&gt;name:$invoiceItem-&gt;product_name??&#39;N/A&#39; }}&lt;/td&gt;</span>
<span class="x">                                                    &lt;td class=&quot;py-4&quot;&gt;{{ number_format($invoiceItem-&gt;quantity,2) }}&lt;/td&gt;</span>
<span class="x">                                                    &lt;td class=&quot;py-4 text-end min-width-130px&quot;&gt;{{  isset($invoiceItem-&gt;price) ? getInvoiceCurrencyAmount($invoiceItem-&gt;price,$invoice-&gt;currency_id,true) : &#39;N/A&#39; }}&lt;/td&gt;</span>
<span class="x">                                                    &lt;td class=&quot;py-4 text-center&quot;&gt;</span>
<span class="x">                                                        @foreach($invoiceItem-&gt;invoiceItemTax as $keys =&gt; $tax)</span>
<span class="x">                                                            {{ ($tax-&gt;tax != 0) ? $tax-&gt;tax : &#39;N/A&#39; }}</span>
<span class="x">                                                            @if (!$loop-&gt;last)</span>
<span class="x">                                                                ,</span>
<span class="x">                                                            @endif</span>
<span class="x">                                                        @endforeach</span>
<span class="x">                                                    &lt;/td&gt;</span>
<span class="x">                                                    &lt;td class=&quot;py-4 text-end min-width-130px&quot;&gt;{{ isset($invoiceItem-&gt;total) ? getInvoiceCurrencyAmount($invoiceItem-&gt;total,$invoice-&gt;currency_id,true) : &#39;N/A&#39; }}&lt;/td&gt;</span>
<span class="x">                                                &lt;/tr&gt;</span>
<span class="x">                                            @endforeach</span>
<span class="x">                                            &lt;/tbody&gt;</span>
<span class="x">                                        &lt;/table&gt;</span>
<span class="x">                                    &lt;/div&gt;</span>
<span class="x">                                    @if(count($invoice-&gt;invoiceTaxes) &gt; 0)</span>
<span class="x">                                        &lt;div class=&quot;col-lg-7&quot;&gt;</span>
<span class="x">                                            &lt;div class=&quot;d-flex align-items-center mt-2&quot;&gt;</span>
<span class="x">                                                &lt;label for=&quot;invoice-taxes&quot;</span>
<span class="x">                                                       class=&quot;fs-4 text-gray-600 me-2&quot;&gt;{{ __(&#39;messages.tax_information&#39;).&#39;:&#39;.&#39; (%)&#39; }}&lt;/label&gt;</span>
<span class="x">                                            &lt;/div&gt;</span>
<span class="x">                                            &lt;div class=&quot;mt-2&quot;&gt;</span>
<span class="x">                                                @foreach($invoice-&gt;invoiceTaxes as $tax)</span>
<span class="x">                                                    &lt;div class=&quot;mb-1&quot;&gt;&lt;b&gt;{{ $tax-&gt;value.&#39;%&#39; }}&lt;/b&gt;{{ &#39; (&#39;. $tax-&gt;name .&#39;)&#39; }}&lt;/div&gt;</span>
<span class="x">                                                @endforeach</span>
<span class="x">                                            &lt;/div&gt;</span>
<span class="x">                                        &lt;/div&gt;</span>
<span class="x">                                    @endif</span>
<span class="x">                                    &lt;div class=&quot;col-lg-5 ms-lg-auto mt-4&quot;&gt;</span>
<span class="x">                                        &lt;div class=&quot;border-top&quot;&gt;</span>
<span class="x">                                            &lt;table class=&quot;table table-borderless box-shadow-none mb-0 mt-5&quot;&gt;</span>
<span class="x">                                                &lt;tbody&gt;</span>
<span class="x">                                                &lt;tr&gt;</span>
<span class="x">                                                    &lt;td class=&quot;ps-0&quot;&gt;{{ __(&#39;messages.invoice.sub_total&#39;).(&#39;:&#39;) }}&lt;/td&gt;</span>
<span class="x">                                                    &lt;td class=&quot;text-gray-900 text-end pe-0&quot;&gt;{{ isset($invoice-&gt;amount) ? getInvoiceCurrencyAmount($invoice-&gt;amount,$invoice-&gt;currency_id,true) : &#39;N/A&#39; }}&lt;/td&gt;</span>
<span class="x">                                                &lt;/tr&gt;</span>
<span class="x">                                                &lt;tr&gt;</span>
<span class="x">                                                    &lt;td class=&quot;ps-0&quot;&gt;{{ __(&#39;messages.invoice.discount&#39;).(&#39;:&#39;) }}&lt;/td&gt;</span>
<span class="x">                                                    @php $percentageDiscount = ($itemTaxesAmount + $invoiceTaxesAmount); @endphp</span>
<span class="x">                                                    &lt;td class=&quot;text-gray-900 text-end pe-0&quot;&gt;</span>
<span class="x">                                                        @if($invoice-&gt;discount == 0 || !isset($invoice))</span>
<span class="x">                                                            &lt;span&gt;N/A&lt;/span&gt;</span>
<span class="x">                                                        @else</span>
<span class="x">                                                            @if( $invoice-&gt;discount_type == \App\Models\Invoice::FIXED)</span>
<span class="x">                                                                {{ getInvoiceCurrencyAmount($invoice-&gt;discount,$invoice-&gt;currency_id,true) }}</span>
<span class="x">                                                            @else</span>
<span class="x">                                                                {{ getInvoiceCurrencyAmount($percentageDiscount * $invoice-&gt;discount / 100,$invoice-&gt;currency_id,true)}}</span>
<span class="x">                                                            @endif</span>
<span class="x">                                                        @endif</span>
<span class="x">                                                    &lt;/td&gt;</span>
<span class="x">                                                &lt;/tr&gt;</span>
<span class="x">                                                &lt;tr&gt;</span>
<span class="x">                                                    &lt;td class=&quot;ps-0&quot;&gt;{{ __(&#39;messages.invoice.tax&#39;).(&#39;:&#39;) }}&lt;/td&gt;</span>
<span class="x">                                                    @php $totalTaxes = (array_sum($totalTax) + $invoiceTaxesAmount)  @endphp</span>
<span class="x">                                                    &lt;td class=&quot;text-gray-900 text-end pe-0&quot;&gt;</span>
<span class="x">                                                        {!!   (numberFormat($totalTaxes) != 0 )</span>
<span class="x">                                                          ? getInvoiceCurrencyAmount($totalTaxes,$invoice-&gt;currency_id,true) :&#39;N/A&#39; !!}</span>
<span class="x">                                                    &lt;/td&gt;</span>
<span class="x">                                                &lt;/tr&gt;</span>
<span class="x">                                                &lt;tr&gt;</span>
<span class="x">                                                    &lt;td class=&quot;ps-0&quot;&gt;{{ __(&#39;messages.invoice.total&#39;).(&#39;:&#39;) }}&lt;/td&gt;</span>
<span class="x">                                                    &lt;td class=&quot;text-gray-900 text-end pe-0&quot;&gt;</span>
<span class="x">                                                        {{ getInvoiceCurrencyAmount($invoice-&gt;final_amount,$invoice-&gt;currency_id,true) }}</span>
<span class="x">                                                    &lt;/td&gt;</span>
<span class="x">                                                &lt;/tr&gt;</span>
<span class="x">                                                &lt;/tbody&gt;</span>
<span class="x">                                            &lt;/table&gt;</span>
<span class="x">                                        &lt;/div&gt;</span>
<span class="x">                                    &lt;/div&gt;</span>
<span class="x">                                &lt;/div&gt;</span>
<span class="x">                            &lt;/div&gt;</span>
<span class="x">                            &lt;div class=&quot;col-xxl-3 mb-5 mb-lg-0&quot;&gt;</span>
<span class="x">                                &lt;div class=&quot;bg-gray-100 rounded-15 p-md-7 p-5 h-100 mt-xxl-0 mt-5 col-xxl-9 ms-xxl-auto w-100&quot;&gt;</span>
<span class="x">                                    &lt;div class=&quot;mb-8&quot;&gt;</span>
<span class="x">                                        @if($invoice-&gt;status == \App\Models\Invoice::UNPAID)</span>
<span class="x">                                            &lt;span class=&quot;badge bg-light-danger&quot;&gt;Pending Payment&lt;/span&gt;</span>
<span class="x">                                        @elseif($invoice-&gt;status == \App\Models\Invoice::PAID)</span>
<span class="x">                                            &lt;span class=&quot;badge bg-light-success me-2&quot;&gt;Paid&lt;/span&gt;</span>
<span class="x">                                        @elseif($invoice-&gt;status == \App\Models\Invoice::PARTIALLY)</span>
<span class="x">                                            &lt;span class=&quot;badge bg-light-primary&quot;&gt;Partially Paid&lt;/span&gt;</span>
<span class="x">                                        @elseif($invoice-&gt;status == \App\Models\Invoice::DRAFT)</span>
<span class="x">                                            &lt;span class=&quot;badge bg-light-warning me-5&quot;&gt;Draft&lt;/span&gt;</span>
<span class="x">                                        @elseif($invoice-&gt;status == \App\Models\Invoice::OVERDUE)</span>
<span class="x">                                            &lt;span class=&quot;badge bg-light-danger&quot;&gt;Overdue&lt;/span&gt;</span>
<span class="x">                                        @elseif($invoice-&gt;status == \App\Models\Invoice::PROCESSING)</span>
<span class="x">                                            &lt;span class=&quot;badge bg-light-primary&quot;&gt;Processing&lt;/span&gt;</span>
<span class="x">                                        @endif</span>
<span class="x">                                        @if($invoice-&gt;status == \App\Models\Invoice::DRAFT)</span>
<span class="x">                                            &lt;button class=&quot;btn btn-success send-btn btn-sm&quot;</span>
<span class="x">                                                    data-id=&quot;{{ $invoice-&gt;id }}&quot;&gt;Send</span>
<span class="x">                                            &lt;/button&gt;</span>
<span class="x">                                        @endif</span>
<span class="x">                                    &lt;/div&gt;</span>

<span class="x">                                    &lt;h3 class=&quot;mb-5&quot;&gt;{{ __(&#39;messages.invoice.client_overview&#39;) }}&lt;/h3&gt;</span>
<span class="x">                                    &lt;div class=&quot;row&quot;&gt;</span>
<span class="x">                                        &lt;div class=&quot;col-xxl-12 col-lg-4 col-sm-6 d-flex flex-column mb-xxl-7 mb-lg-0 mb-4&quot;&gt;</span>
<span class="x">                                            &lt;label for=&quot;name&quot;</span>
<span class="x">                                                   class=&quot;pb-2 fs-4 text-gray-600&quot;&gt;{{ __(&#39;messages.invoice.client_name&#39;) }}&lt;/label&gt;</span>
<span class="x">                                            @if($auth)</span>
<span class="x">                                                &lt;a href=&quot;{{ route(&#39;clients.show&#39;, [&#39;client&#39; =&gt; $invoice-&gt;client-&gt;id]) }}&quot;</span>
<span class="x">                                                   class=&quot;link-primary text-decoration-none&quot;&gt;{{ $invoice-&gt;client-&gt;user-&gt;full_name }}&lt;/a&gt;</span>

<span class="x">                                            @else</span>
<span class="x">                                                &lt;a href=&quot;#&quot;</span>
<span class="x">                                                   class=&quot;link-primary fs-4 text-decoration-none&quot;&gt;{{ $invoice-&gt;client-&gt;user-&gt;full_name }}&lt;/a&gt;</span>
<span class="x">                                            @endif</span>
<span class="x">                                        &lt;/div&gt;</span>
<span class="x">                                        &lt;div class=&quot;col-xxl-12 col-lg-4 col-sm-6 d-flex flex-column mb-xxl-7 mb-lg-0 mb-4&quot;&gt;</span>
<span class="x">                                            &lt;label for=&quot;name&quot;</span>
<span class="x">                                                   class=&quot;pb-2 fs-4 text-gray-600&quot;&gt;{{ __(&#39;messages.invoice.client_email&#39;) }}&lt;/label&gt;</span>
<span class="x">                                            &lt;span class=&quot;fs-4 text-gray-900&quot;&gt;{{ $invoice-&gt;client-&gt;user-&gt;email }}&lt;/span&gt;</span>
<span class="x">                                        &lt;/div&gt;</span>
<span class="x">                                        &lt;div class=&quot;col-xxl-12 col-lg-4 col-sm-6 d-flex flex-column mb-xxl-7&quot;&gt;</span>
<span class="x">                                            &lt;label for=&quot;name&quot;</span>
<span class="x">                                                   class=&quot;pb-2 fs-4 text-gray-600&quot;&gt;{{ __(&#39;messages.invoice.paid_amount&#39;) }}&lt;/label&gt;</span>
<span class="x">                                            &lt;span class=&quot;fs-4 text-gray-900&quot;&gt;{{ getInvoiceCurrencyAmount(getInvoicePaidAmount($invoice-&gt;id),$invoice-&gt;currency_id,true) }}&lt;/span&gt;</span>
<span class="x">                                        &lt;/div&gt;</span>
<span class="x">                                        &lt;div class=&quot;col-xxl-12 col-lg-4 col-sm-6 d-flex flex-column mb-xxl-7&quot;&gt;</span>
<span class="x">                                            &lt;label for=&quot;name&quot;</span>
<span class="x">                                                   class=&quot;pb-2 fs-4 text-gray-600&quot;&gt;{{ __(&#39;messages.invoice.remaining_amount&#39;) }}&lt;/label&gt;</span>
<span class="x">                                            &lt;span class=&quot;fs-4 text-gray-900&quot;&gt;{{ getInvoiceCurrencyAmount(getInvoiceDueAmount($invoice-&gt;id),$invoice-&gt;currency_id,true) }}</span>
<span class="x">                                                &lt;/span&gt;</span>
<span class="x">                                        &lt;/div&gt;</span>
<span class="x">                                        @if($invoice-&gt;recurring_status == 1)</span>
<span class="x">                                            &lt;div class=&quot;col-xxl-12 col-lg-4 col-sm-6 d-flex flex-column mb-xxl-7&quot;&gt;</span>
<span class="x">                                                &lt;label for=&quot;name&quot;</span>
<span class="x">                                                       class=&quot;pb-2 fs-4 text-gray-600&quot;&gt;{{ __(&#39;messages.invoice.last_recurring_on&#39;) }}&lt;/label&gt;</span>
<span class="x">                                                &lt;span class=&quot;fs-4 text-gray-900&quot;&gt;{{ $invoice-&gt;last_recurring_on  ? \Carbon\Carbon::parse($invoice-&gt;last_recurring_on)-&gt;translatedFormat(currentDateFormat()) : &#39;N/A&#39;}}&lt;/span&gt;</span>
<span class="x">                                            &lt;/div&gt;</span>
<span class="x">                                            &lt;div class=&quot;col-xxl-12 col-lg-4 col-sm-6 d-flex flex-column mb-xxl-7&quot;&gt;</span>
<span class="x">                                                &lt;label for=&quot;name&quot;</span>
<span class="x">                                                       class=&quot;pb-2 fs-4 text-gray-600&quot;&gt;{{ __(&#39;messages.invoice.recurring_cycle&#39;) }}&lt;/label&gt;</span>
<span class="x">                                                &lt;span class=&quot;fs-4 text-gray-900&quot;&gt;{{ $invoice-&gt;recurring_cycle }}</span>
<span class="x">                                                &lt;/span&gt;</span>
<span class="x">                                            &lt;/div&gt;</span>
<span class="x">                                        @endif</span>
<span class="x">                                        @if(!$auth &amp;&amp; $invoice-&gt;status !== \App\Models\Invoice::PAID)</span>
<span class="x">                                            &lt;a target=&quot;_blank&quot;</span>
<span class="x">                                               href=&quot;{{ route(&#39;invoices.public-payment&#39;, [&#39;invoiceId&#39; =&gt; $invoice-&gt;invoice_id]) }}&quot;</span>
<span class="x">                                               data-id=&quot;{{$invoice-&gt;id}}&quot;</span>
<span class="x">                                               class=&quot;btn btn-warning mt-5 payment&quot;&gt;{{ __(&#39;messages.invoice.make_payment&#39;) }}&lt;/a&gt;</span>
<span class="x">                                        @endif</span>
<span class="x">                                    &lt;/div&gt;</span>
<span class="x">                                &lt;/div&gt;</span>
<span class="x">                            &lt;/div&gt;</span>
<span class="x">                        &lt;/div&gt;</span>
<span class="x">                    &lt;/div&gt;</span>
<span class="x">                &lt;/div&gt;</span>
<span class="x">            &lt;/div&gt;</span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">        &lt;div class=&quot;tab-pane fade show&quot; id=&quot;note_terms&quot; role=&quot;tabpanel&quot;&gt;</span>
<span class="x">            &lt;div class=&quot;card&quot;&gt;</span>
<span class="x">                &lt;div class=&quot;card-body pt-5&quot;&gt;</span>
<span class="x">                    &lt;div class=&quot;row&quot;&gt;</span>
<span class="x">                        &lt;div class=&quot;col-lg-12 mb-5&quot;&gt;</span>
<span class="x">                            &lt;div class=&quot;fw-bold text-gray-600 fs-7&quot;&gt;{{ __(&#39;messages.invoice.note&#39;).&#39;:&#39; }}&lt;/div&gt;</span>
<span class="x">                            &lt;div class=&quot;fs-6&quot;&gt;{!! $invoice-&gt;note ?? __(&#39;messages.invoice.note_not_found&#39;) !!}&lt;/div&gt;</span>
<span class="x">                        &lt;/div&gt;</span>
<span class="x">                        &lt;div class=&quot;col-lg-12 mb-5&quot;&gt;</span>
<span class="x">                            &lt;div class=&quot;fw-bold text-gray-600 fs-7&quot;&gt;{{ __(&#39;messages.invoice.terms&#39;).&#39;:&#39; }}&lt;/div&gt;</span>
<span class="x">                            &lt;div class=&quot;fs-6&quot;&gt;{!! $invoice-&gt;term ?? __(&#39;messages.invoice.terms_not_found&#39;) !!}&lt;/div&gt;</span>
<span class="x">                        &lt;/div&gt;</span>
<span class="x">                    &lt;/div&gt;</span>
<span class="x">                &lt;/div&gt;</span>
<span class="x">            &lt;/div&gt;</span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">        &lt;div class=&quot;tab-pane fade show&quot; id=&quot;paymentHistory&quot; role=&quot;tabpanel&quot;&gt;</span>
<span class="x">            &lt;div class=&quot;row&quot;&gt;</span>
<span class="x">                &lt;div class=&quot;col-lg-12 &quot;&gt;</span>
<span class="x">                    &lt;livewire:payment-history-table invoiceId=&quot;{{ $invoice-&gt;id }}&quot;/&gt;</span>
<span class="x">                &lt;/div&gt;</span>
<span class="x">            &lt;/div&gt;</span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">        @if($invoice-&gt;parentInvoice)</span>
<span class="x">            &lt;div class=&quot;tab-pane fade show&quot; id=&quot;parentInvoiceDetail&quot; role=&quot;tabpanel&quot; aria-labelledby=&quot;overview-tab&quot;&gt;</span>
<span class="x">                &lt;div class=&quot;card&quot;&gt;</span>
<span class="x">                    &lt;div class=&quot;card-body&quot;&gt;</span>
<span class="x">                        &lt;div class=&quot;row&quot;&gt;</span>
<span class="x">                            &lt;div class=&quot;col-sm-6 d-flex flex-column mb-md-10 mb-5&quot;&gt;</span>
<span class="x">                                &lt;label for=&quot;name&quot; class=&quot;pb-2 fs-4 text-gray-600&quot;&gt;{{ __(&#39;messages.invoice.invoice&#39;) }}</span>
<span class="x">                                    :&lt;/label&gt;</span>
<span class="x">                                &lt;a href=&quot;{{ route(&#39;invoices.show&#39;,$invoice-&gt;parentInvoice-&gt;id) }}&quot; target=&quot;_blank&quot;</span>
<span class="x">                                   class=&quot;fs-4 text-decoration-none text-primary&quot;&gt;#{{ $invoice-&gt;parentInvoice-&gt;invoice_id }}&lt;/a&gt;</span>
<span class="x">                            &lt;/div&gt;</span>
<span class="x">                            &lt;div class=&quot;col-sm-6 d-flex flex-column mb-md-10 mb-5&quot;&gt;</span>
<span class="x">                                &lt;label for=&quot;name&quot; class=&quot;pb-2 fs-4 text-gray-600&quot;&gt;{{ __(&#39;messages.common.status&#39;) }}</span>
<span class="x">                                    :&lt;/label&gt;</span>
<span class="x">                                &lt;span class=&quot;fs-4 text-gray-800&quot;&gt;{{ $invoice-&gt;parentInvoice-&gt;status_label }}&lt;/span&gt;</span>
<span class="x">                            &lt;/div&gt;</span>
<span class="x">                            &lt;div class=&quot;col-sm-6 d-flex flex-column mb-md-10 mb-5&quot;&gt;</span>
<span class="x">                                &lt;label for=&quot;name&quot;</span>
<span class="x">                                       class=&quot;pb-2 fs-4 text-gray-600&quot;&gt;{{ __(&#39;messages.invoice.invoice_date&#39;) }}</span>
<span class="x">                                    :&lt;/label&gt;</span>
<span class="x">                                &lt;span class=&quot;fs-4 text-gray-800&quot;&gt;{{ \Carbon\Carbon::parse($invoice-&gt;parentInvoice-&gt;invoice_date)-&gt;translatedFormat(currentDateFormat()) }}&lt;/span&gt;</span>
<span class="x">                            &lt;/div&gt;</span>
<span class="x">                            &lt;div class=&quot;col-sm-6 d-flex flex-column mb-md-10 mb-5&quot;&gt;</span>
<span class="x">                                &lt;label for=&quot;name&quot; class=&quot;pb-2 fs-4 text-gray-600&quot;&gt;{{ __(&#39;messages.invoice.due_date&#39;) }}</span>
<span class="x">                                    :&lt;/label&gt;</span>
<span class="x">                                &lt;span class=&quot;fs-4 text-gray-800&quot;&gt;{{ \Carbon\Carbon::parse($invoice-&gt;parentInvoice-&gt;due_date)-&gt;translatedFormat(currentDateFormat()) }}&lt;/span&gt;</span>
<span class="x">                            &lt;/div&gt;</span>
<span class="x">                            &lt;div class=&quot;col-sm-6 d-flex flex-column mb-md-10 mb-5&quot;&gt;</span>
<span class="x">                                &lt;label for=&quot;name&quot;</span>
<span class="x">                                       class=&quot;pb-2 fs-4 text-gray-600&quot;&gt;{{ __(&#39;messages.invoice.paid_amount&#39;) }}</span>
<span class="x">                                    :&lt;/label&gt;</span>
<span class="x">                                &lt;span class=&quot;fs-4 text-gray-800&quot;&gt;{{ getInvoiceCurrencyAmount(getInvoicePaidAmount($invoice-&gt;parentInvoice-&gt;id),$invoice-&gt;parentInvoice-&gt;currency_id,true) }}&lt;/span&gt;</span>
<span class="x">                            &lt;/div&gt;</span>
<span class="x">                            &lt;div class=&quot;col-sm-6 d-flex flex-column mb-md-10 mb-5&quot;&gt;</span>
<span class="x">                                &lt;label for=&quot;name&quot;</span>
<span class="x">                                       class=&quot;pb-2 fs-4 text-gray-600&quot;&gt;{{ __(&#39;messages.invoice.remaining_amount&#39;) }}</span>
<span class="x">                                    :&lt;/label&gt;</span>
<span class="x">                                &lt;span class=&quot;fs-4 text-gray-800&quot;&gt;{{ getInvoiceCurrencyAmount(getInvoiceDueAmount($invoice-&gt;parentInvoice-&gt;id),$invoice-&gt;parentInvoice-&gt;currency_id,true) }}&lt;/span&gt;</span>
<span class="x">                            &lt;/div&gt;</span>
<span class="x">                        &lt;/div&gt;</span>
<span class="x">                    &lt;/div&gt;</span>
<span class="x">                &lt;/div&gt;</span>
<span class="x">            &lt;/div&gt;</span>
<span class="x">        @endif</span>
<span class="x">        &lt;div class=&quot;tab-pane fade show&quot; id=&quot;recurringInvoices&quot; role=&quot;tabpanel&quot;&gt;</span>
<span class="x">            &lt;div class=&quot;row&quot;&gt;</span>
<span class="x">                &lt;div class=&quot;col-lg-12 &quot;&gt;</span>
<span class="x">                    &lt;livewire:recurring-invoices-table invoiceId=&quot;{{ $invoice-&gt;id }}&quot;/&gt;</span>
<span class="x">                &lt;/div&gt;</span>
<span class="x">            &lt;/div&gt;</span>
<span class="x">        &lt;/div&gt;</span>
<span class="x">    &lt;/div&gt;</span>
<span class="x">&lt;/div&gt;</span>
</code></pre></div>
<p>This Blade view represents the display of invoice details in a Laravel application. Here's an explanation of the code:</p>
<ol>
<li>
<p><strong>PHP Section</strong>:</p>
</li>
<li>
<p>In this section, several PHP variables are initialized, including <code>$auth</code>, <code>$itemTaxesAmount</code>, and <code>$invoiceTaxesAmount</code>. These variables are used to calculate values and perform logic for displaying invoice details.</p>
</li>
<li>
<p><strong>HTML Structure</strong>:</p>
</li>
<li>
<p>The view is structured using HTML and Blade directives.</p>
</li>
<li>
<p><strong>Tab Navigation</strong>:</p>
</li>
<li>
<p>If the user is authenticated (<code>$auth</code>) and the view is intended for public display (<code>$isPublicView</code>), a tab navigation menu is displayed. This menu allows users to switch between different sections of the invoice details, such as "Overview," "Note &amp; Terms," "Payment History," and possibly others depending on the invoice's status and related data.</p>
</li>
<li>
<p><strong>Overview Tab</strong>:</p>
</li>
<li>
<p>The "Overview" tab displays general invoice information, including invoice ID, invoice date, due date, client details, product items, taxes, discounts, and the total amount.</p>
</li>
<li>
<p><strong>Status Badge and Send Button</strong>:</p>
</li>
<li>
<p>The invoice's status is displayed as a badge, and a "Send" button is shown for invoices in draft status (<code>\App\Models\Invoice::DRAFT</code>).</p>
</li>
<li>
<p><strong>Client Overview</strong>:</p>
</li>
<li>
<p>Client-related information is displayed, including the client's name, email, paid amount, and remaining amount. If the invoice is recurring, additional information about the last recurring date and cycle is displayed.</p>
</li>
<li>
<p><strong>Make Payment Button</strong>:</p>
</li>
<li>
<p>If the user is not authenticated and the invoice status is not paid (<code>\App\Models\Invoice::PAID</code>), a "Make Payment" button is displayed, allowing the user to make a payment.</p>
</li>
<li>
<p><strong>Note &amp; Terms Tab</strong>:</p>
</li>
<li>
<p>The "Note &amp; Terms" tab displays any notes and terms associated with the invoice.</p>
</li>
<li>
<p><strong>Payment History Tab</strong>:</p>
</li>
<li>
<p>The "Payment History" tab uses Livewire to load a payment history table for the invoice.</p>
</li>
<li>
<p><strong>Parent Invoice Detail Tab</strong> (if applicable):</p>
<ul>
<li>If the invoice has a parent invoice (<code>$invoice-&gt;parentInvoice</code>), a tab displaying the parent invoice details is shown.</li>
</ul>
</li>
<li>
<p><strong>Recurring Invoices Tab</strong>:</p>
<ul>
<li>The "Recurring Invoices" tab uses Livewire to load a table of recurring invoices related to the current invoice.</li>
</ul>
</li>
</ol>
<p>Overall, this Blade view provides a comprehensive display of invoice details, including general invoice information, client details, payment history, related invoices (if applicable), and more. It also handles conditional rendering of elements based on user authentication and invoice status.</p>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.220ee61c.min.js"></script>
      
    
  </body>
</html>